"use strict";define("Test/TestPlansHubRefresh/Pivots/ExecutePivot",["require","exports","redux/Utils/ActionHelper","immer","redux-saga","Test/TestPlansHubRefresh/TestHub/Constants","Test/TestPlansHubRefresh/TestHub/Redux/Suites/SuitesActions","Test/TestPlansHubRefresh/TestHub/Redux/TelemetryActions","Test/TestPlansHubRefresh/TestHub/Redux/TestHubRefresh/TestHubRefreshSelector","VSS/Redux/Modules/ContentViewObserver/index","Reselect","Test/TestPlansHubRefresh/Pivots/ColumnOptions/ExecuteColumnOptionUtils","Test/TestPlansHubRefresh/TestHub/Resources","VSS/Core/Observable","react","Test/TestPlansHubRefresh/Pivots/ColumnOptions/ColumnOptionsCommonUtils","Test/TestPlansHubRefresh/TestHub/Redux/Suites/SuitesSelector","Test/TestPlansHubRefresh/TestHub/Redux/TestHubRefresh/TestHubRefreshActions","Test/TestPlansHubRefresh/TestHub/Util","Test/TestPlansHubRefresh/TestHub/Utils/TestPlansHubRefreshLocalContextProvider","VSS/Core/Util/String","VSS/Legacy/Legacy","VSS/Platform/Util/Cookie","VSS/Core/Util/Accessibility","VSSUI/Spinner","VSS/Platform/Feature","Test/TestPlansHubRefresh/TestHub/Redux/TestHubRefresh/TestHubRefreshReducer","react-redux","redux-dynamic-modules","Test/TestPlansHubRefresh/TestHub/Utils/TestHubRefreshFilterCommon","VSS/Features/PlatformUI/ContributedMenu","VSS/Platform/Layout","VSS/Platform/Location","VSS/Redux/Modules/TTIMonitor/index","VSSUI/Button","VSSUI/Card","VSSUI/Header","VSSUI/HeaderCommandBar","VSSUI/List","VSSUI/Menu","VSSUI/Observer","VSSUI/SplitButton","VSSUI/Splitter","VSSUI/Table","VSSUI/Utilities/Dispatch","VSSUI/Utilities/ScreenSize","VSSUI/ZeroData","Wit/WorkItemForm/WorkItemFormView"],(function(e,t,s,o,n,i,a,l,r,c,d,u,p,f,T,m,h,C,S,y,g,I,P,E,R,b,_,x,A,F,v,O,H,k,N,L,w,M,D,U,W,V,B,K,X,Y,z,j){var G,Z,q,J,$,Q,ee,te,se,oe,ne,ie;G=t.Resources={},t.Resources.Outcome="Outcome",t.Resources.TestCaseId="Test Case Id",t.Resources.Title="Title",t.Resources.Configuration="Configuration",t.Resources.Tester="Tester",t.Resources.Order="Order",t.Resources.NotApplicable="Not Applicable",t.Resources.TestPoints="Test Points",t.Resources.Passed="Passed",t.Resources.Failed="Failed",t.Resources.Active="Active",t.Resources.Blocked="Blocked",t.Resources.Inconclusive="Inconclusive",t.Resources.NotExecuted="Not executed",t.Resources.NotImpacted="Not impacted",t.Resources.Timeout="Timeout",t.Resources.Warning="Warning",t.Resources.Error="Error",t.Resources.RunTests="Run",t.Resources.InProgress="In Progress",t.Resources.Paused="Paused",t.Resources.Refresh="Refresh",t.Resources.ZeroDataPrimaryText="Add test cases via the Define tab first!",t.Resources.ZeroDataSecondaryText="Use Execute tab to assign and execute test points",t.Resources.ZeroDataImageText="No tests to execute",t.Resources.TextFilterPlaceholderText="Search Title, Test case id and Tags columns",t.Resources.OutcomeFilterPlaceholderText="Outcome",t.Resources.TesterFilterPlaceholderText="Tester",t.Resources.ConfigurationFilterPlaceholderText="Configuration",t.Resources.AssignedToFilterPlaceholderText="Assigned To",t.Resources.StateFilterPlaceholderText="State",t.Resources.NoItemSelected="You must select atleast one test point",t.Resources.UnassignedIdentity="Unassigned",t.Resources.AssignTesterMenuItemText="Assign tester",t.Resources.IdentityPickerPlaceholderText="Search users",t.Resources.ViewTestResult="View test result",t.Resources.ResumeTestMenuItemText="Resume test",t.Resources.ResumeTestForWebApplication="Resume for web application",t.Resources.ResumeTestForDesktopApplication="Resume for desktop application",t.Resources.ResetTestToActive="Reset test to active",t.Resources.ViewExecutionHistory="View execution history",t.Resources.MarkOutcome="Mark Outcome",t.Resources.PassTest="Pass Test",t.Resources.FailTest="Fail Test",t.Resources.BlockTest="Block Test",t.Resources.RunForWebApplication="Run for web application",t.Resources.RunForDesktop="Run for desktop application",t.Resources.RunWithOptions="Run with options",t.Resources.EditTestCase="Edit test case",t.Resources.EditTestCases="Edit test case(s)",t.Resources.ErrorFetchingPointsText="Unable to fetch test points.",t.Resources.SeeRunTestOptions="See run test options",t.Resources.BulkMarkTestPoints="bulk mark test points",t.Resources.RunContainsAutomatedPointsWarning="One or more of the selected test cases are automated. Do you want to run these tests manually?",t.Resources.Ok="OK",t.Resources.Cancel="Cancel",t.Resources.MoveAndReorderTestCasesDisabled="Go to define tab to reorder or move test cases",t.Resources.TestPointCountText="Showing {0} test points",t.Resources.ZeroTestPointText="No test points match your filter criteria",t.Resources.LargeSuiteCountToast="You have {0} suites within the current suite. Please use the 'Show test points from child suites' feature on a suite with lesser number of children to avoid performance issues",Z=t.ExecuteConstants={},t.ExecuteConstants.ExecuteTabZeroDataImagePath="ms.vss-test-web/testplan-hub-refresh-assets/zero-data-execute-tab.png",t.ExecuteConstants.UnassignedIdentityIconPath="ms.vss-test-web/testplan-hub-refresh-assets/unassigned-icon.svg",t.ExecuteConstants.ExecutePivotName="Execute",t.ExecuteConstants.AssignTesterIconName="PeopleAdd",t.ExecuteConstants.ViewTestResultIconName="History",t.ExecuteConstants.ResumeTestIconName="PlayResume",t.ExecuteConstants.UnassignedIdentityGuid="00000000-0000-0000-0000-000000000000",t.ExecuteConstants.User="user",t.ExecuteConstants.Scope="ims",t.ExecuteConstants.HideDTRLaunchDialogCookieName="HideDTRLaunchDialog",t.ExecuteConstants.WorkItemTypeCategoryForWebRunner="Microsoft.BugCategory",t.ExecuteConstants.DefaultWorkItemTypeForWebRunner="Bug",t.ExecuteConstants.TestCaseWorkItemType="Test Case",t.ExecuteConstants.TestResultsContributionId="ms.vss-test-web.test-runs-route",t.ExecuteConstants.queryParams="?_a=resultSummary&runId={0}&resultId={1}",t.ExecuteConstants.ResetTestToActiveIconName="Refresh",t.ExecuteConstants.ViewExecutionHistoryIconName="History",t.ExecuteConstants.MarkOutcomeIconName="CheckMark",t.ExecuteConstants.PassTestIconName="CompletedSolid",t.ExecuteConstants.FailTestIconName="StatusErrorFull",t.ExecuteConstants.BlockTestIconName="Blocked2Solid",t.ExecuteConstants.NotApplicableIconName="BlockedSolid",t.ExecuteConstants.RunIconName="Play",t.ExecuteConstants.EditTestIconName="Edit",t.ExecuteConstants.SuiteCountThreshold="SuiteCountThreshold",t.ExecuteConstants.SuiteTestCasesBatchSize=200,t.ExecuteConstants.TestCaseIdColumn="TestCaseIdColumn",t.ExecuteConstants.OrderColumn="OrderColumn",t.ExecuteConstants.OutcomeColumn="OutcomeColumn",t.ExecuteConstants.TitleColumn="TitleColumn",t.ExecuteConstants.TesterColumn="TesterColumn",t.ExecuteConstants.ConfigurationColumn="ConfigurationColumn",t.ExecuteConstants.ConfirmationDialogType="dialog",t.ExecuteConstants.TestPointDragItemType="test-point-item",t.ExecuteConstants.DragTestPointsText="test points",t.ExecuteConstants.WorkItemTypeCategoryTestCase="Microsoft.TestCaseCategory",q=t.ReduxPointsActions={},t.ReduxPointsActions.PointsActions={initializeExecutePivot:()=>(0,s.createAction)("Points/initializeExecutePivot"),loadInitialTestPoints:()=>(0,s.createAction)("Points/loadInitialTestPoints"),loadInitialTestPointsSucceeded:e=>(0,s.createAction)("Points/loadInitialTestPointsSucceeded",e),loadTestPointsForSelectedSuiteSucceded:(e,t)=>(0,s.createAction)("Points/loadTestPointsForSelectedSuiteSucceded",{testPoints:e,reload:t}),loadTestPointsForSelectedSuite:(e,t,o)=>(0,s.createAction)("Points/loadTestPointsForSelectedSuite",{testPlanId:e,testSuiteId:t,continuationToken:o}),updateTestPointsForSelectedSuite:(e,t,o)=>(0,s.createAction)("Points/updateTestPointsForSelectedSuite",{updateTestPoints:e,testPlanId:t,testSuiteId:o}),updateTestPointsForSelectedSuiteSucceded:e=>(0,s.createAction)("Points/updateTestPointsForSelectedSuiteSucceded",e),openApplicationTestRunner:e=>(0,s.createAction)("Points/openApplicationTestRunner",e),openApplicationTestRunnerToResumeTest:e=>(0,s.createAction)("Points/openApplicationTestRunnerToResumeTest",e),openApplicationTestRunnerClick:e=>(0,s.createAction)("Points/openApplicationTestRunnerClick",e),openApplicationTestRunnerClickToResumeTest:e=>(0,s.createAction)("Points/openApplicationTestRunnerClickToResumeTest",e),openTestPointsRunnerClient:e=>(0,s.createAction)("Points/openTestPointsRunnerClient",e),resumeTest:(e,t,o)=>(0,s.createAction)("Points/resumeTest",{pointToResume:e,planId:t,suiteId:o}),refreshTestPointsForWebRunner:(e,t,o)=>(0,s.createAction)("Points/refreshTestPointsForWebRunner",{testPlanId:e,testSuiteId:t,testPointIds:o}),unloadPreviousTestPoints:()=>(0,s.createAction)("Points/unloadPreviousTestPoints"),updateFilteredTestPoints:e=>(0,s.createAction)("Points/updateFilteredTestPoints",{filteredTestPoints:e}),updateAssignTesterDropdownState:e=>(0,s.createAction)("Points/updateAssignTesterDropdownState",e),openExistingTestCaseWitForm:(e,t,o,n,i,a,l)=>(0,s.createAction)("Points/openExistingTestCaseWitForm",{planId:e,suiteId:t,testCaseId:o,testCaseTitle:n,testCaseState:i,testCaseAssignedTo:a,testPoints:l}),updateAllTestPointsByTestCaseId:(e,t,o,n,i,a)=>(0,s.createAction)("Points/updateAllTestPointsByTestCaseId",{testCaseId:e,testCaseTitle:t,testCaseState:o,testCaseAssignedTo:n,testPoints:i,columnOptions:a}),openTestResult:(e,t,o)=>(0,s.createAction)("Points/openTestResult",{pointId:e,runId:t,resultId:o}),updateColumnAndSortOrder:(e,t)=>(0,s.createAction)("Points/updateColumnAndSortOrder",{columnId:e,proposedSortOrder:t}),loadTestPointColumnOptionsForSelectedSuiteSucceeded:(e,t)=>(0,s.createAction)("Points/loadTestPointColumnOptionsForSelectedSuiteSucceeded",{testCases:e,reload:t}),saveColumnWidths:e=>(0,s.createAction)("Points/saveColumnWidths",{columnAndWidthMap:e}),fetchColumnWidths:()=>(0,s.createAction)("Points/fetchColumnWidths",{}),openAutomatedTestCasesConfirmationDialog:e=>(0,s.createAction)("Points/openAutomatedTestCasesConfirmationDialog",e),bulkEditTestCases:(e,t,o,n)=>(0,s.createAction)("Points/bulkEditTestCases",{testPointIds:e,testCaseIds:t,planId:o,suiteId:n}),filterPointsInState:()=>(0,s.createAction)("Points/filterPointsInState",{}),fetchSuitePointCounts:()=>(0,s.createAction)("Points/fetchSuitePointCounts",{})},J=t[ie="ReduxPointsFilterReducer"]={},t[ie].PointsFilterReducer=function(e,t){return e=e||{},(0,o.default)(e,(e=>{"Points/updateFilteredTestPoints"===t.type&&(e.filteredTestPointIds=t.payload.filteredTestPoints)}))},function(e){function s(e){const t={};if(e)for(const s of e)t[s.id]=s;return t}function n(e){const t={};if(e)for(const s of e)for(const e of s.pointAssignments)t[e.id]=s;return t}$=t.ReduxPointsReducer={},t.ReduxPointsReducer.PointsReducer=function(e,t){return e=e||{},(0,o.default)(e,(e=>{switch(t.type){case"Points/loadInitialTestPointsSucceeded":e.testPoints=s(t.payload),e.columnAndSortOrder={columnId:Z.TestCaseIdColumn,sortOrder:void 0};break;case"Points/loadTestPointsForSelectedSuiteSucceded":if(e.columnAndSortOrder=Object.assign({},e.columnAndSortOrder),!e.testPoints||t.payload.reload)e.testPoints=s(t.payload.testPoints);else{const o=s(t.payload.testPoints);e.testPoints=Object.assign(Object.assign({},e.testPoints),o)}break;case"Points/loadTestPointColumnOptionsForSelectedSuiteSucceeded":if(!e.testCases||t.payload.reload)e.testCases=n(t.payload.testCases);else{const s=n(t.payload.testCases);e.testCases=Object.assign(Object.assign({},e.testCases),s)}break;case"Points/unloadPreviousTestPoints":e.testPoints=void 0;break;case"Points/updateTestPointsForSelectedSuiteSucceded":const o=t.payload;if(o&&o.length>0)for(const t of o)e.testPoints[t.id]=t;break;case"Points/updateAssignTesterDropdownState":e.assignTesterDropDownState=t.payload;break;case"Points/updateAllTestPointsByTestCaseId":const i=t.payload.testPoints;for(let s=0;s<i.length;s++){if(i[s].testCaseRef.id===t.payload.testCaseId){const o=i[s].id;if(e.testPoints[o].testCaseReference.name=t.payload.testCaseTitle,e.testPoints[o].testCaseReference.state=t.payload.testCaseState,e.testPoints[o].testCaseReference.assignedTo&&(e.testPoints[o].testCaseReference.assignedTo.displayName=t.payload.testCaseAssignedTo),t.payload.columnOptions&&e.testCases){const s=e.testCases[o];for(const e in t.payload.columnOptions){const o=s.workItem.workItemFields.findIndex((t=>t.hasOwnProperty(e)));-1===o?s.workItem.workItemFields.push({[e]:t.payload.columnOptions[e]}):s.workItem.workItemFields[o]={[e]:t.payload.columnOptions[e]}}e.testCases[o]=s}}}break;case"Points/updateColumnAndSortOrder":const{columnId:a,proposedSortOrder:l}=t.payload;e.columnAndSortOrder.columnId=a,e.columnAndSortOrder.sortOrder=l}}))},t.ReduxPointsReducer.generateTestPointMap=s,t.ReduxPointsReducer.generateColumnOptionsMap=n,t.ReduxPointsReducer.getTestPointsLength=function(e){return Object.keys(e).length}}(),function(e){function s(e,t){if(t){const s=t[i.TestHubRefreshConstants.EXECUTE_TEXT_FILTER_ITEM_KEY];if(p(s)&&s.value.trim().length>0){const t=s.value.trim();let o=!1,n=!1,a=!1;if(e&&e.testCaseRef&&t&&(o=-1!==e.testCaseRef.title.toLocaleLowerCase().indexOf(t.toLocaleLowerCase()),n=-1!==e.testCaseRef.id.toString().indexOf(t),e.columnOptionValues&&e.columnOptionValues[i.TestHubRefreshConstants.WorkItemField_Tags])){const s=e.columnOptionValues[i.TestHubRefreshConstants.WorkItemField_Tags].split(" ;");for(const e of s)if(-1!==e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())){a=!0;break}}return o||n||a}}return!0}function o(e,t){let s=!0,o=!0,n=!0,a=!0,l=!0;return e&&t&&(s=d(e.outcomeItem.outcomeString,t[i.TestHubRefreshConstants.EXECUTE_OUTCOME_FILTER_ITEM_KEY]),o=d(e.tester.displayName,t[i.TestHubRefreshConstants.EXECUTE_TESTER_FILTER_ITEM_KEY]),n=d(e.configuration.name,t[i.TestHubRefreshConstants.EXECUTE_CONFIGURATION_FILTER_ITEM_KEY]),a=d(e.testCaseRef.assignedTo.displayName,t[i.TestHubRefreshConstants.EXECUTE_ASSIGNEDTO_FILTER_ITEM_KEY]),l=d(e.testCaseRef.state,t[i.TestHubRefreshConstants.EXECUTE_STATE_FILTER_ITEM_KEY])),s&&o&&n&&a&&l}function d(e,t){if(p(t)){for(const s of t.value)if(s.key===e)return!0;return!1}return!0}function u(e){let t=4;switch(e){case 2:t=3;break;case 7:t=1;break;case 3:t=2;break;case 13:t=0;break;case 11:t=5;break;case 12:t=6;break;default:t=4}return t}function p(e){return e&&e.value&&e.value.length>0}Q=t[e]={},t[e].fetchFilteredSuitePointCounts=function*(e){const t=function(e){const t=[],s=[];let o;const n=[],a=[];if(p(e[i.TestHubRefreshConstants.EXECUTE_CONFIGURATION_FILTER_ITEM_KEY]))for(const t of e[i.TestHubRefreshConstants.EXECUTE_CONFIGURATION_FILTER_ITEM_KEY].value){const e=t.value;a.push(e.id)}if(p(e[i.TestHubRefreshConstants.EXECUTE_TESTER_FILTER_ITEM_KEY]))for(const t of e[i.TestHubRefreshConstants.EXECUTE_TESTER_FILTER_ITEM_KEY].value){const e=t.value,s=e?e.id:t.data.value.id;n.push(s)}if(p(e[i.TestHubRefreshConstants.EXECUTE_OUTCOME_FILTER_ITEM_KEY]))for(const t of e[i.TestHubRefreshConstants.EXECUTE_OUTCOME_FILTER_ITEM_KEY].value){o=u(t.value.outcome);break}if(p(e[i.TestHubRefreshConstants.EXECUTE_ASSIGNEDTO_FILTER_ITEM_KEY]))for(const t of e[i.TestHubRefreshConstants.EXECUTE_ASSIGNEDTO_FILTER_ITEM_KEY].value){const e=t.value.id;s.push(e)}if(p(e[i.TestHubRefreshConstants.EXECUTE_STATE_FILTER_ITEM_KEY]))for(const s of e[i.TestHubRefreshConstants.EXECUTE_STATE_FILTER_ITEM_KEY].value){const e=s.value;t.push(e)}return{states:t,assignedTo:s,outcome:o,testers:n,configurations:a}}(yield n.effects.select(c.getCurrentFilterState));yield n.effects.put(a.SuitesActions.getSuitePointCount(e,t.states,t.configurations,t.testers,t.assignedTo,t.outcome))},t[e].filterTestPoints=function*(e,t){let a;const d=yield n.effects.select(c.getCurrentFilterState);if(!e)return a;a=[];for(const t of e){const e=s(t,d),n=o(t,d);e&&n&&a.push(t.id)}const u={pivot:i.TestHubRefreshConstants.EXECUTE_TAB_ID,resultsCount:a.length,planId:t,isAdvancedLicenseEnabled:yield n.effects.select(r.isAdvancedLicenseEnabled),textFilterHasValue:p(d[i.TestHubRefreshConstants.EXECUTE_TEXT_FILTER_ITEM_KEY]),outcomeFilterHasValue:p(d[i.TestHubRefreshConstants.EXECUTE_OUTCOME_FILTER_ITEM_KEY]),testerFilterHasValue:p(d[i.TestHubRefreshConstants.EXECUTE_TESTER_FILTER_ITEM_KEY]),configurationFilterHasValue:p(d[i.TestHubRefreshConstants.EXECUTE_CONFIGURATION_FILTER_ITEM_KEY])};return yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.FILTER_VALUES_CHANGED,u)),a}}("ReduxPointsFilterHelper"),function(e){ee=t[e]={};t[e].getTestPointItemsComparator=function(e,t){const s=0===t||void 0===t?1:-1;return e===Z.TestCaseIdColumn?(e,t)=>s*(e.testCaseRef.id-t.testCaseRef.id):e===Z.OrderColumn?(e,t)=>e.order&&t.order?s*(e.order-t.order):0:e===Z.OutcomeColumn?(e,t)=>s*e.outcomeItem.outcomeString.localeCompare(t.outcomeItem.outcomeString):e===Z.TitleColumn?(e,t)=>s*e.testCaseRef.title.localeCompare(t.testCaseRef.title):e===Z.TesterColumn?(e,t)=>s*e.tester.displayName.localeCompare(t.tester.displayName):e===Z.ConfigurationColumn?(e,t)=>s*e.configuration.name.localeCompare(t.configuration.name):e?(t,o)=>{const n=t.columnOptionValues[e],i=o.columnOptionValues[e];return s*(n>i?1:n==i?0:-1)}:void 0}}("TestPointsSortingUtility"),function(e){te=t.ReduxPointsSelector={};t.ReduxPointsSelector.getTestPointsMapFromState=e=>e.executeState.testPoints;t.ReduxPointsSelector.getColumnAndSortOrder=e=>{if(e&&e.executeState)return e.executeState.columnAndSortOrder};t.ReduxPointsSelector.isAnyExecuteFilterValueSet=e=>{let t=!1;const s=[i.TestHubRefreshConstants.EXECUTE_TEXT_FILTER_ITEM_KEY,i.TestHubRefreshConstants.EXECUTE_OUTCOME_FILTER_ITEM_KEY,i.TestHubRefreshConstants.EXECUTE_TESTER_FILTER_ITEM_KEY,i.TestHubRefreshConstants.EXECUTE_CONFIGURATION_FILTER_ITEM_KEY,i.TestHubRefreshConstants.EXECUTE_ASSIGNEDTO_FILTER_ITEM_KEY,i.TestHubRefreshConstants.EXECUTE_STATE_FILTER_ITEM_KEY];if(e)for(const o of s){const s=e[o];if(s&&s.value&&s.value.length){t=!0;break}}return t};t.ReduxPointsSelector.getFilteredTestPoints=e=>{if(e&&e.executeFilterState)return e.executeFilterState.filteredTestPointIds};t.ReduxPointsSelector.getWITColumnOptionFields=e=>{if(e&&e.testHubRefreshState&&e.testHubRefreshState.executeColumnOptionFields)return(0,u.getWITColumnFields)(e.testHubRefreshState.executeColumnOptionFields).join(",")};t.ReduxPointsSelector.getWITColumnOptionFieldsArray=e=>{let t=[];return e&&e.testHubRefreshState&&e.testHubRefreshState.executeColumnOptionFields&&(t=(0,u.getWITColumnFields)(e.testHubRefreshState.executeColumnOptionFields)),t};t.ReduxPointsSelector.getTestCaseItemsFromState=e=>{if(e.executeState&&e.executeState.testCases)return e.executeState.testCases};t.ReduxPointsSelector.hasColumnOptionsLoadStarted=e=>!!(e&&e.executeState&&e.executeState.testCases);t.ReduxPointsSelector.getTestPointsCount=e=>{if(e&&e.executeState&&e.executeState.testPoints)return Object.keys(e.executeState.testPoints).length};t.ReduxPointsSelector.getTestPointsFromState=e=>Object.keys(e.executeState.testPoints).map((e=>parseInt(e))).map((t=>e.executeState.testPoints[t]));t.ReduxPointsSelector.getTestPointsFromTestPointItems=(e,s)=>{const o=[];if(s&&s.length>0){const n=(0,t.ReduxPointsSelector.getTestPointsMapFromState)(e);for(const e of s)e&&null!=e.id&&o.push(n[e.id])}return o};t.ReduxPointsSelector.getTestPointItemsFromState=(e,s,o)=>{if(e.executeState&&e.executeState.testPoints){const n=(0,t.ReduxPointsSelector.getTestPointsFromState)(e);return(0,t.ReduxPointsSelector.getTestPointItemsFromTestPoint)(n,s,o)}};t.ReduxPointsSelector.getTestPointItemsFromTestPoint=(e,r,c)=>{const d=[];if(e)for(let p=0;p<e.length;p++)d.push({id:s(e[p]),outcomeItem:o(e[p]),tester:(0,t.ReduxPointsSelector._getTestPointTester)(e[p]),configuration:a(e[p]),state:n(e[p]),testCaseRef:l(e[p]),lastResultId:e[p].results?e[p].results.lastResultId:0,lastRunId:e[p].results?e[p].results.lastTestRunId:0,isAutomated:!!e[p].isAutomated&&e[p].isAutomated}),r&&c&&(d[p].columnOptionValues=(0,u.getAllColumnValues)([i.TestHubRefreshConstants.WorkItemField_Tags],c[e[p].id],e[p]));return d},t.ReduxPointsSelector.getTestPointsToRender=d.createSelector(t.ReduxPointsSelector.getTestPointsMapFromState,t.ReduxPointsSelector.getTestPointItemsFromState,t.ReduxPointsSelector.getTestCaseItemsFromState,r.getExecuteColumnOptionFields,t.ReduxPointsSelector.getFilteredTestPoints,t.ReduxPointsSelector.getColumnAndSortOrder,((e,s,o,n,i,a)=>{const l=[],r=[];let c=[];if(!i){if(s){if(e&&o&&n)for(const t of s){const s=t.id;t.columnOptionValues=(0,u.getAllColumnValues)(n,o[s],e[s]),o[s]&&o[s].order?t.order=o[s].order+1:t.order=1}s=s.sort((0,ee.getTestPointItemsComparator)(a.columnId,a.sortOrder))}return s}if(i&&0===i.length)return l;for(let t=0;t<i.length;t++)e[i[t]]&&r.push(e[i[t]]);if(r){if(c=(0,t.ReduxPointsSelector.getTestPointItemsFromTestPoint)(r),e&&o&&n)for(const t of c){const s=t.id;t.columnOptionValues=(0,u.getAllColumnValues)(n,o[s],e[s]),o[s]&&o[s].order?t.order=o[s].order+1:t.order=1}c&&(c=c.sort((0,ee.getTestPointItemsComparator)(a.columnId,a.sortOrder)))}return c})),t.ReduxPointsSelector.getUniqueFilterValuesToRender=d.createSelector(t.ReduxPointsSelector.getTestPointItemsFromState,(e=>{const s=new f.ObservableArray,o=new f.ObservableArray,n=new f.ObservableArray,a=new f.ObservableArray,l=new f.ObservableArray;if(e&&e.length>0){const i=new Map,r=new Map,c=new Map,d=new Map,u=new Map;for(const p of e){if(!i.has(p.outcomeItem.outcomeString)){i.set(p.outcomeItem.outcomeString,p.id);const e={id:p.outcomeItem.outcomeString,text:p.outcomeItem.outcomeString,data:{key:p.outcomeItem.outcomeString,value:p.outcomeItem},iconProps:(0,t.ReduxPointsSelector._getTesterFilterItemIconProps)(p.outcomeItem)};s.push(e)}if(p.tester&&!r.has(p.tester.id.toLowerCase())){r.set(p.tester.id.toLowerCase(),p.id);const e={id:p.tester.displayName,text:p.tester.displayName,data:{key:p.tester.displayName,value:p.tester}};o.push(e)}if(p.configuration&&p.configuration.name&&!c.has(p.configuration.name)){c.set(p.configuration.name,p.id);const e={id:p.configuration.name,text:p.configuration.name,data:{key:p.configuration.name,value:p.configuration}};n.push(e)}if(!d.has(p.testCaseRef.assignedTo.id.toLowerCase())){d.set(p.testCaseRef.assignedTo.id.toLowerCase(),p.id);const e={id:p.testCaseRef.assignedTo.displayName,text:p.testCaseRef.assignedTo.displayName,data:{key:p.testCaseRef.assignedTo.displayName,value:p.testCaseRef.assignedTo}};a.push(e)}if(!u.has(p.testCaseRef.state)){u.set(p.testCaseRef.state,p.id);const e={id:p.testCaseRef.state,text:p.testCaseRef.state,data:{key:p.testCaseRef.state,value:p.testCaseRef.state}};l.push(e)}}}const r={};return r[i.TestHubRefreshConstants.EXECUTE_OUTCOME_FILTER_ITEM_KEY]=s,r[i.TestHubRefreshConstants.EXECUTE_TESTER_FILTER_ITEM_KEY]=o,r[i.TestHubRefreshConstants.EXECUTE_CONFIGURATION_FILTER_ITEM_KEY]=n,r[i.TestHubRefreshConstants.EXECUTE_ASSIGNEDTO_FILTER_ITEM_KEY]=a,r[i.TestHubRefreshConstants.EXECUTE_STATE_FILTER_ITEM_KEY]=l,r}));t.ReduxPointsSelector._getTestPointTester=e=>{let t={displayName:p.UnassignedString,id:i.TestHubRefreshConstants.EmptyGuid};if(e&&e.tester&&e.tester.displayName){t={displayName:(0,r.getIdentityDisplayString)(e.tester.displayName),id:e.tester.id}}return t};const s=e=>e.id;t.ReduxPointsSelector._getTesterFilterItemIconProps=e=>{let t="CircleFill",s="active-icon";const o={iconName:t,className:s};switch(e.outcome){case 2:t="CompletedSolid",s="pass-icon";break;case 3:t="StatusErrorFull",s="fail-icon";break;case 7:t="Blocked2Solid",s="block-icon";break;case 11:t="BlockedSolid",s="not-applicable-icon";break;case 12:t="CirclePauseSolid",s="active-icon";break;case 13:t="AwayStatus",s="active-icon";break;default:t="CircleFill",s="active-icon"}return o.iconName=t,o.className=s,o};const o=e=>{const t=e.results.outcome;let s={};return s=4===n(e)?12===t?{outcome:e.results.outcome,outcomeString:G.Paused}:{outcome:13,outcomeString:G.InProgress}:2===t?{outcome:e.results.outcome,outcomeString:G.Passed}:3===t?{outcome:e.results.outcome,outcomeString:G.Failed}:7===t?{outcome:e.results.outcome,outcomeString:G.Blocked}:11===t?{outcome:e.results.outcome,outcomeString:G.NotApplicable}:12===t?{outcome:e.results.outcome,outcomeString:G.Paused}:4===t?{outcome:4,outcomeString:G.Inconclusive}:8===t?{outcome:8,outcomeString:G.NotExecuted}:14===t?{outcome:14,outcomeString:G.NotImpacted}:5===t?{outcome:5,outcomeString:G.Timeout}:9===t?{outcome:9,outcomeString:G.Warning}:10===t?{outcome:10,outcomeString:G.Error}:13===t?{outcome:e.results.outcome,outcomeString:G.InProgress}:{outcome:e.results.outcome,outcomeString:G.Active},s},n=e=>e.results.state,a=e=>{const t={id:-1,name:""};return e&&e.configuration&&(t.id=e.configuration.id,t.name=e.configuration.name),t},l=e=>{const t={id:-1,assignedTo:{displayName:p.UnassignedString,id:i.TestHubRefreshConstants.EmptyGuid},state:"",title:""};if(e&&e.testCaseReference){if(e.testCaseReference.assignedTo){const s=e.testCaseReference.assignedTo;t.assignedTo.displayName=s.displayName?s.displayName:s.uniqueName,t.assignedTo.id=s.id?s.id:i.TestHubRefreshConstants.EmptyGuid}t.id=e.testCaseReference.id,t.state=e.testCaseReference.state,t.title=e.testCaseReference.name}return t}}(),function(e){function*s(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"ITfsPageService"),o=yield n.effects.call([s,s.getData]);if(!o||!o.project)throw new Error("Project missing");yield n.effects.put(a.SuitesActions.updateLoadingStatus(!0));const l=o.project.id;yield n.effects.select(r.isAdvancedLicenseEnabled);let d={projectId:l,filterState:{},filterVisible:!1,filterKey:"testPlansHubFilterKey"};const u=yield n.effects.select(c.getFilterDetails);if(u){if(d=u,u.filterState&&u.filterState[i.TestHubRefreshConstants.AUTHOR_TEXT_FILTER_ITEM_KEY]){const e=u.filterState[i.TestHubRefreshConstants.AUTHOR_TEXT_FILTER_ITEM_KEY].value;e&&e.trim().length>0&&(d.filterState[i.TestHubRefreshConstants.EXECUTE_TEXT_FILTER_ITEM_KEY]=u.filterState[i.TestHubRefreshConstants.AUTHOR_TEXT_FILTER_ITEM_KEY])}u.filterState&&u.filterState[i.TestHubRefreshConstants.AUTHOR_STATE_FILTER_ITEM_KEY]&&(d.filterState[i.TestHubRefreshConstants.EXECUTE_STATE_FILTER_ITEM_KEY]=u.filterState[i.TestHubRefreshConstants.AUTHOR_STATE_FILTER_ITEM_KEY]),u.filterState&&u.filterState[i.TestHubRefreshConstants.AUTHOR_ASSIGNEDTO_FILTER_ITEM_KEY]&&(d.filterState[i.TestHubRefreshConstants.EXECUTE_ASSIGNEDTO_FILTER_ITEM_KEY]=u.filterState[i.TestHubRefreshConstants.AUTHOR_ASSIGNEDTO_FILTER_ITEM_KEY])}yield n.effects.put(c.ContentViewObserverActions.initializeFilterState(d)),yield n.effects.put(q.PointsActions.filterPointsInState()),yield n.effects.put(q.PointsActions.fetchSuitePointCounts())}function*o(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.select(r.getExecuteColumnOptionFields),o=(0,u.getAllPossibleFields)(),a=yield n.effects.call([t,t.getService],"IVssLayoutManager"),c=yield n.effects.call(n.channel),d={onSuccess:(e,t,s)=>{!function(e,t,s,o){e.put({displayColumns:t,displayColumnNames:s,newColumnsAdded:o})}(c,e,t,s)},existingColumnFields:s,allColumnFields:o.map((e=>({referenceName:e.key,displayName:e.name})))};yield n.effects.call([a,a.renderCallout],(e=>{const t={modules:["TestManagement/Scripts/Shared/ColumnOptionsPanelProxy"],wrappedType:"column-options-panel-proxy",wrappedProps:d};return T.createElement(I.LegacyComponent,t)}));const p=yield n.effects.take(c),f=yield n.effects.select(r.getExecuteColumnOptionFields),S=p.displayColumns;let y={};if(p.displayColumns.forEach(((e,t)=>{(0,m.isCustomField)(e)&&(y[e]=p.displayColumnNames[t])})),yield n.effects.put(C.TestHubRefreshActions.updateExecuteTabCustomColumnFieldMap(y)),yield n.effects.put(C.TestHubRefreshActions.loadExecuteColumnOptionFieldsSucceeded(p.displayColumns)),p.newColumnsAdded)if((0,b.isFeatureFlagEnabled)(t,i.TestHubRefreshConstants.FetchTestPointColumnOptionsRecursively,!1)){const t=yield n.effects.select(te.getWITColumnOptionFields);yield n.effects.call(k,e.payload.suiteId,e.payload.planId,t)}else{const t=(yield n.effects.select(h.getIdToTestSuiteMap)).get(e.payload.suiteId),s=yield n.effects.select(r.isShowTestsFromChildSuitesEnabled);let o=[];t&&s?o=j(t):o.push(e.payload.suiteId);for(let t=0;t<o.length;t+=Z.SuiteTestCasesBatchSize)yield n.effects.call(H,o.slice(t,Math.min(o.length,t+Z.SuiteTestCasesBatchSize)),e.payload.planId)}const g={NewExecuteColumnOptions:p.displayColumns&&p.displayColumns.length>0?p.displayColumns.join(","):""},P=yield n.effects.call([t,t.getService],"ISettingsService"),E=yield n.effects.call([t,t.getService],"ITfsPageService"),R=yield n.effects.call([E,E.getData]);yield n.effects.call([P,P.setEntries],g,0,"project",R.project.id);const _={planId:e.payload.planId,suiteId:e.payload.suiteId,oldColumnOptionFields:f,newColumnOptionFields:S,isAdvancedLicenseEnabled:yield n.effects.select(r.isAdvancedLicenseEnabled),pivot:i.TestHubRefreshConstants.EXECUTE_TAB_ID};yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.COLUMN_OPTIONS_EDIT,_))}function*d(){const e=yield n.effects.select(r.getPlanId),t=yield n.effects.call(_);let s,o=yield n.effects.select(r.getExecuteColumnOptionFields),a=!1;if(o)for(const e of o)if(e===i.TestHubRefreshConstants.WorkItemField_Tags){a=!0;break}a&&(s=yield n.effects.select(te.getTestCaseItemsFromState));const l=yield n.effects.select(te.getTestPointItemsFromState,a,s);if(t){y.testHubRefreshLocalContextData.setIsExecuteFilterActiveOrSet(!0);const t=yield n.effects.call(Q.filterTestPoints,l,e),s=t&&t.length>0?(0,g.format)(G.TestPointCountText,t.length):G.ZeroTestPointText;(0,E.announce)(s),yield n.effects.put(q.PointsActions.updateFilteredTestPoints(t))}else{y.testHubRefreshLocalContextData.setIsExecuteFilterActiveOrSet(!1);const e=l&&l.length>0?(0,g.format)(G.TestPointCountText,l.length):G.ZeroTestPointText;(0,E.announce)(e),yield n.effects.put(q.PointsActions.updateFilteredTestPoints(void 0))}}function*p(){const e=yield n.effects.select(r.getPlanId);(yield n.effects.call(_))?yield n.effects.call(Q.fetchFilteredSuitePointCounts,e):yield n.effects.put(a.SuitesActions.getSuitePointCount(e,[],[],[],[],void 0))}function*f(e){const t=yield n.effects.call(_),s={isFilterVisible:yield n.effects.select(c.isFilterVisible),isFilterActive:t,pivot:i.TestHubRefreshConstants.EXECUTE_TAB_ID,isAdvancedLicenseEnabled:yield n.effects.select(r.isAdvancedLicenseEnabled)};yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.FILTER_TOGGLED,s))}function*_(){const e=yield n.effects.select(c.isFilterActive),t=yield n.effects.select(c.getCurrentFilterState),s=yield n.effects.call(te.isAnyExecuteFilterValueSet,t);return e||s}function*x(){const e=yield n.effects.getContext("pageContext"),t=yield n.effects.call([e,e.getService],"ISettingsService"),s=yield n.effects.call([e,e.getService],"ITfsPageService"),o=yield n.effects.call([s,s.getData]);let a=yield n.effects.call([t,t.getEntriesAsync],"",0,"project",o.project.id);return a&&a[Z.SuiteCountThreshold]?a[Z.SuiteCountThreshold]:i.TestHubRefreshConstants.DEFAULT_SUITE_COUNT_THRESHOLD}function*A(e){const t=yield n.effects.getContext("pageContext");let s={SelectedSuiteId:e.payload.selectedSuiteId.toString()};const o=yield n.effects.call([t,t.getService],"ISettingsService"),i=yield n.effects.call([t,t.getService],"ITfsPageService"),a=yield n.effects.call([i,i.getData]);yield n.effects.call([o,o.setEntries],s,0,"project",a.project.id),yield n.effects.put(q.PointsActions.updateFilteredTestPoints(void 0)),yield n.effects.put(q.PointsActions.unloadPreviousTestPoints()),yield n.effects.put(q.PointsActions.loadTestPointsForSelectedSuite(e.payload.planId,e.payload.selectedSuiteId))}function*F(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"ITfsPageService"),o=yield n.effects.call([s,s.getData]);let a="";o&&o.project&&(a=o.project.name);const c=yield n.effects.call([t,t.getService],"IVssLocationService"),d={project:a};let u=yield n.effects.call([c,c.routeUrl],Z.TestResultsContributionId,d);u+=(0,g.format)(Z.queryParams,e.payload.runId,e.payload.resultId);const p=yield n.effects.call([window,window.open],u,"_blank");p&&(p.opener=null);const f={planId:yield n.effects.select(r.getPlanId),suiteId:yield n.effects.select(r.getSelectedSuiteId),pointId:e.payload.pointId,isAdvancedLicenseEnabled:yield n.effects.select(r.isAdvancedLicenseEnabled),runId:e.payload.runId,resultId:e.payload.resultId};yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.OPEN_TEST_RESULT,f))}function*v(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call(S.getDataProviderContent,t);yield n.effects.put(q.PointsActions.loadInitialTestPointsSucceeded(s.testPoints)),s.testPoints&&(yield n.effects.put(a.SuitesActions.updateLoadingStatus(!1))),yield n.effects.put(C.TestHubRefreshActions.updateExecuteTabCustomColumnFieldMap(s.executeTabCustomColumnFieldMap)),(yield n.effects.select(r.getExecuteColumnOptionFields))||(yield n.effects.put(C.TestHubRefreshActions.loadExecuteColumnOptionFieldsSucceeded(s.executeColumnOptionFields))),yield n.effects.put(q.PointsActions.fetchColumnWidths())}function*O(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"ITestHubDataService"),o=yield n.effects.call(S.getDataProviderContent,t),c=yield n.effects.select(r.isShowTestsFromChildSuitesEnabled);let d,u=!1,p=e.payload.continuationToken;p||(u=!0,d=yield n.effects.select(te.getTestPointsCount),p=(0,g.format)("{0};{1}",i.TestHubRefreshConstants.INT_MIN_VALUE,i.TestHubRefreshConstants.INITIAL_PAGE_SIZE)),u&&!d&&(yield n.effects.put(a.SuitesActions.updateLoadingStatus(!0))),(yield n.effects.select(r.getExecuteColumnOptionFields))||(yield n.effects.put(C.TestHubRefreshActions.updateExecuteTabCustomColumnFieldMap(o.executeTabCustomColumnFieldMap)),yield n.effects.put(C.TestHubRefreshActions.loadExecuteColumnOptionFieldsSucceeded(o.executeColumnOptionFields))),yield n.effects.put(C.TestHubRefreshActions.updatePagingStatus(!0));let f;try{f=yield n.effects.call([s,s.getTestPointsForSuite],e.payload.testPlanId,e.payload.testSuiteId,void 0,void 0,p,true,!0,c)}catch(e){(0,S.showErrorToast)(t,G.ErrorFetchingPointsText,e.message,G.Refresh,(()=>{window.location.reload()}))}f&&(yield n.effects.put(q.PointsActions.loadTestPointsForSelectedSuiteSucceded(f.results,u)),"Suites/showTestsFromChildSuitesClick"===e.type&&(yield n.effects.put(q.PointsActions.fetchSuitePointCounts())));(yield n.effects.call(_))&&(yield n.effects.put(q.PointsActions.filterPointsInState())),u&&(yield n.effects.put(a.SuitesActions.updateLoadingStatus(!1)));const T=yield n.effects.select(te.hasColumnOptionsLoadStarted);let m=[];if(u||!T){if(c&&f&&f.results){m=j((yield n.effects.select(h.getIdToTestSuiteMap)).get(e.payload.testSuiteId));const t=yield n.effects.call(x);t&&m.length-1>t&&(yield n.effects.put(a.SuitesActions.showToastNotifications((0,g.format)(G.LargeSuiteCountToast,m.length),i.TestHubRefreshConstants.LONG_TOAST_MESSAGE_DURATION)))}else m.push(e.payload.testSuiteId);if((0,b.isFeatureFlagEnabled)(t,i.TestHubRefreshConstants.FetchTestPointColumnOptionsRecursively,!1)){const t=yield n.effects.select(te.getWITColumnOptionFields);yield n.effects.call(k,e.payload.testSuiteId,e.payload.testPlanId,t)}else for(let t=0;t<m.length;t+=Z.SuiteTestCasesBatchSize)yield n.effects.call(H,m.slice(t,Math.min(m.length,t+Z.SuiteTestCasesBatchSize)),e.payload.testPlanId)}const y=yield n.effects.select(r.getTestPointPageSize);if(f&&f.continuationToken){const t=f.continuationToken.split(";");t&&2==t.length&&(t[1]=y.toString(),f.continuationToken=t.join(";")),yield n.effects.put(q.PointsActions.loadTestPointsForSelectedSuite(e.payload.testPlanId,e.payload.testSuiteId,f.continuationToken))}if(yield n.effects.put(C.TestHubRefreshActions.updatePagingStatus(!1)),f&&!f.continuationToken){const t={planId:e.payload.testPlanId,suiteId:e.payload.testSuiteId,testPointsCount:yield n.effects.select(te.getTestPointsCount),isAdvancedLicenseEnabled:yield n.effects.select(r.isAdvancedLicenseEnabled),testPointPageSize:y};yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.GET_TEST_POINTS_FOR_SUITE,t))}}function*H(e,t){const s=yield n.effects.select(te.getWITColumnOptionFields);for(let o=0;o<e.length;o++)yield n.effects.fork(k,e[o],t,s)}function*k(e,t,s,o){const a=yield n.effects.getContext("pageContext"),l=yield n.effects.call([a,a.getService],"ITestHubDataService"),c=yield n.effects.select(r.isShowTestsFromChildSuitesEnabled),d=(0,b.isFeatureFlagEnabled)(a,i.TestHubRefreshConstants.FetchTestPointColumnOptionsRecursively,!1),u=c&&d;let p,f=!1;o||c||(f=!0);try{p=yield n.effects.call([l,l.getTestCasesForSuite],t,e,void 0,void 0,s,o,!0,0,!0,u)}catch(e){console.error(e)}p&&(yield n.effects.put(q.PointsActions.loadTestPointColumnOptionsForSelectedSuiteSucceeded(p.results,f)));(yield n.effects.call(_))&&(yield n.effects.put(q.PointsActions.filterPointsInState()));const T=yield n.effects.select(r.getTestPointPageSize);if(p&&p.continuationToken){const o=p.continuationToken.split(";");o&&2==o.length&&(o[1]=T.toString(),p.continuationToken=o.join(";")),yield n.effects.call(k,e,t,s,p.continuationToken)}}function*N(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"ITestHubDataService");yield n.effects.put(C.TestHubRefreshActions.updateBusyViewStatus(!0));const o=yield n.effects.call([s,s.updateTestPoints],e.payload.updateTestPoints,e.payload.testPlanId,e.payload.testSuiteId,!0,!0);yield n.effects.put(q.PointsActions.updateTestPointsForSelectedSuiteSucceded(o));(yield n.effects.select(r.getInitiallySelectedSuiteId))===e.payload.testSuiteId&&y.testHubRefreshLocalContextData.makeJsonIslandDataDirty(),yield n.effects.put(C.TestHubRefreshActions.updateBusyViewStatus(!1));(yield n.effects.call(_))&&(yield n.effects.put(q.PointsActions.filterPointsInState()),yield n.effects.put(q.PointsActions.fetchSuitePointCounts()))}function*L(e){let t=!1;const s=e.payload.points;for(let e=0;e<s.length;e++)if(s[e].isAutomated){t=!0;break}if("true"===(yield n.effects.call([P,P.getCookie],Z.HideDTRLaunchDialogCookieName)))t?yield n.effects.put(q.PointsActions.openAutomatedTestCasesConfirmationDialog(e.payload)):yield n.effects.put(q.PointsActions.openApplicationTestRunner(e.payload));else{const s=yield n.effects.getContext("pageContext"),o=yield n.effects.call([s,s.getService],"IVssLayoutManager"),i=yield n.effects.call(n.channel),a={onLaunch:()=>{i.put(e.payload)}};yield n.effects.call([o,o.renderCallout],(e=>{const t={modules:["TestManagement/Scripts/Shared/RunWithDTRProxy"],wrappedType:"run-dtr-proxy",wrappedProps:a};return T.createElement(I.LegacyComponent,t)}));const l=yield n.effects.take(i);t?yield n.effects.put(q.PointsActions.openAutomatedTestCasesConfirmationDialog(l)):yield n.effects.put(q.PointsActions.openApplicationTestRunner(l))}}function*w(e){if(e.payload.points&&e.payload.points.length>0){if("true"===(yield n.effects.call([P,P.getCookie],Z.HideDTRLaunchDialogCookieName)))yield n.effects.put(q.PointsActions.openApplicationTestRunnerToResumeTest(e.payload));else{const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"IVssLayoutManager"),o=yield n.effects.call(n.channel),i={onLaunch:()=>{o.put(e.payload)}};yield n.effects.call([s,s.renderCallout],(e=>{const t={modules:["TestManagement/Scripts/Shared/RunWithDTRProxy"],wrappedType:"run-dtr-proxy",wrappedProps:i};return T.createElement(I.LegacyComponent,t)}));const a=yield n.effects.take(o);yield n.effects.put(q.PointsActions.openApplicationTestRunnerToResumeTest(a))}}else{const t={planId:e.payload.planId,suiteId:e.payload.suiteId,isAdvancedLicenseEnabled:yield n.effects.select(r.isAdvancedLicenseEnabled)};yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.LAUNCH_APPLICATION_TEST_RUNNER_FAILURE,t))}}function*M(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call(n.channel),o=yield n.effects.call([t,t.getService],"IGlobalMessagesService");yield n.effects.call([o,o.addDialog],{componentType:Z.ConfirmationDialogType,contentDependencies:["ms.vss-features.ui-layer-content"],contentProperties:{titleProps:{text:G.RunContainsAutomatedPointsWarning},footerButtonProps:[{text:G.Cancel,onClick:()=>{o.closeDialog()}},{text:G.Ok,onClick:()=>{s.put(e.payload),o.closeDialog()},primary:!0}]}},!0,!0);const i=yield n.effects.take(s);yield n.effects.put(q.PointsActions.openApplicationTestRunner(i))}function*D(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"ITestHubDataService");yield n.effects.put(C.TestHubRefreshActions.updateBusyViewStatus(!0));const o=yield n.effects.call([s,s.createTestSettings],e.payload.planAreaPath),a=yield n.effects.select(te.getTestPointsFromTestPointItems,e.payload.points),c=yield n.effects.call([s,s.createTestRun],e.payload.planId,e.payload.planName,e.payload.planIteration,a,e.payload.suiteName,o,e.payload.selectedBuild);yield n.effects.call([s,s.openApplicationTestRunner],c.id,e.payload.suiteId),yield n.effects.put(C.TestHubRefreshActions.updateBusyViewStatus(!1));const d={};for(var u=0;u<e.payload.points.length;u++)d[e.payload.points[u].id]=e.payload.points[u].outcomeItem.outcome;const p={planId:e.payload.planId,suiteId:e.payload.suiteId,pointsCount:e.payload.points.length,pointIdToStateMapping:d,isAdvancedLicenseEnabled:yield n.effects.select(r.isAdvancedLicenseEnabled)};yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.LAUNCH_APPLICATION_TEST_RUNNER,p))}function*U(e){try{const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"ITestHubDataService");yield n.effects.put(C.TestHubRefreshActions.updateBusyViewStatus(!0));const o=e.payload.points[0].lastRunId,a={id:o};yield n.effects.call([s,s.openApplicationTestRunner],a.id,e.payload.suiteId),yield n.effects.put(C.TestHubRefreshActions.updateBusyViewStatus(!1));const c={planId:e.payload.planId,suiteId:e.payload.suiteId,pointId:e.payload.points[0].id,runId:o,isAdvancedLicenseEnabled:yield n.effects.select(r.isAdvancedLicenseEnabled)};yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.LAUNCH_APPLICATION_TEST_RUNNER_TO_RESUME_TEST,c))}catch(t){const s={planId:e.payload.planId,suiteId:e.payload.suiteId,pointsCount:e.payload.points.length,isAdvancedLicenseEnabled:yield n.effects.select(r.isAdvancedLicenseEnabled),exceptionMessage:t.message};yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.LAUNCH_APPLICATION_TEST_RUNNER_FAILURE,s))}}function*W(e){const t=yield n.effects.call(n.channel),s=yield n.effects.getContext("pageContext"),o=yield n.effects.call([s,s.getService],"IVssContributionService");yield n.effects.call([o,o.getContributionsAsync],["ms.vss-features.ui-responsive-viewport-content","ms.vss-work-web.common-content"]);const a=yield n.effects.select(te.getWITColumnOptionFieldsArray),c=yield n.effects.call([s,s.getService],"work-item-service");if(!c)throw new Error("Unable to fetch workitem service instance.");yield n.effects.call([c,c.openWorkItem],e.payload.testCaseId,{save:s=>{const o=s.getTitle(),n=s.getState();let l=s.getFieldValue(i.TestHubRefreshConstants.WorkItemField_AssignedTo);l=(0,r.getIdentityDisplayString)(l);const c={};for(const e of a)c[e]=s.getFieldValue(e);t.put({testCaseId:e.payload.testCaseId,testCaseTitle:o,testCaseState:n,testCaseAssignedTo:l,columnOptions:c})}});const d=yield n.effects.take(t);yield n.effects.put(q.PointsActions.updateAllTestPointsByTestCaseId(d.testCaseId,d.testCaseTitle,d.testCaseState,d.testCaseAssignedTo,e.payload.testPoints,d.columnOptions));(yield n.effects.call(_))&&(yield n.effects.put(q.PointsActions.filterPointsInState()),yield n.effects.put(q.PointsActions.fetchSuitePointCounts()));const u={suiteId:e.payload.suiteId,planId:e.payload.planId,testCaseId:d.testCaseId,isAdvancedLicenseEnabled:yield n.effects.select(r.isAdvancedLicenseEnabled)};yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.EDIT_TEST_CASE_USING_FORM,u))}function*V(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"ITfsPageService"),o=yield n.effects.call([s,s.getData]);yield n.effects.put(C.TestHubRefreshActions.updateBusyViewStatus(!0));const a=yield n.effects.call([t,t.getRestClient],"IWorkItemTrackingRestClient"),c=yield n.effects.call([a,a.getWorkItemTypeCategory],o.project.id,Z.WorkItemTypeCategoryForWebRunner),d=yield n.effects.call([t,t.getService],"ITestHubDataService"),u=yield n.effects.call([d,d.getTestPlanById],e.payload.planId),p=yield n.effects.call([t,t.getService],"IVssPageService"),f=yield n.effects.call([p,p.getData]),m=yield n.effects.select(h.getTestSuiteById,e.payload.suiteId),S=yield n.effects.call(n.channel),g={testPoints:e.payload.points,selectedSuite:m,plan:{id:e.payload.planId,name:e.payload.planName,iteration:e.payload.planIteration,areaPath:e.payload.planAreaPath,buildUri:e.payload.selectedBuild?e.payload.selectedBuild.url:"",buildDefinitionId:u.buildDefinition?u.buildDefinition.id:void 0,releaseEnvironmentDefinition:u.releaseEnvironmentDefinition},bugCategoryType:c?c.defaultWorkItemType.name:Z.DefaultWorkItemTypeForWebRunner,ownerId:f?f.user.id:null,errorCallBack:e=>{console.error(e)},successCallBack:()=>{S.put(e.payload)},selectedBuild:e.payload.selectedBuild,releaseDefinition:e.payload.releaseDefinition,environmentId:e.payload.environmentId,runOption:e.payload.runOptions,selectedDataCollectors:e.payload.dataCollectors},P=yield n.effects.call([t,t.getService],"IVssLayoutManager");yield n.effects.call([P,P.renderCallout],(e=>{const t={modules:["TestManagement/Scripts/Shared/RunTestPointsProxy"],wrappedType:"run-test-points-proxy",wrappedProps:g};return T.createElement(I.LegacyComponent,t)})),yield n.effects.put(C.TestHubRefreshActions.updateBusyViewStatus(!1));const E={};for(var R=0;R<e.payload.points.length;R++)E[e.payload.points[R].id]=e.payload.points[R].outcomeItem.outcome;const b={suiteId:e.payload.suiteId,planId:e.payload.planId,pointsCount:e.payload.points.length,pointIdToStateMapping:E,isAdvancedLicenseEnabled:yield n.effects.select(r.isAdvancedLicenseEnabled)};1==e.payload.runOptions?yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.LAUNCH_WEB_RUNNER,b)):7==e.payload.runOptions?yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.LAUNCH_RUN_WITH_OPTIONS_WEB_RUNNER,b)):4==e.payload.runOptions?yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.AUTOMATED_TEST_RUN,b)):5==e.payload.runOptions?yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.RUN_WITH_OLD_MTM,b)):6==e.payload.runOptions&&(yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.RUN_WITH_NEW_MTM,b)));const _=yield n.effects.take(S);yield n.effects.put(q.PointsActions.refreshTestPointsForWebRunner(_.planId,_.suiteId,y.testHubRefreshLocalContextData.getWebRunnerPointIds()))}function*B(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"ITfsPageService"),o=yield n.effects.call([s,s.getData]);yield n.effects.put(C.TestHubRefreshActions.updateBusyViewStatus(!0));const a=yield n.effects.call([t,t.getRestClient],"IWorkItemTrackingRestClient"),c=yield n.effects.call([a,a.getWorkItemTypeCategory],o.project.id,Z.WorkItemTypeCategoryForWebRunner),d={testPoints:[e.payload.pointToResume],selectedSuite:yield n.effects.select(h.getTestSuiteById,e.payload.suiteId),bugCategoryType:c?c.defaultWorkItemType.name:Z.DefaultWorkItemTypeForWebRunner,errorCallBack:e=>{console.error(e)}},u=yield n.effects.call([t,t.getService],"IVssLayoutManager");yield n.effects.call([u,u.renderCallout],(e=>{const t={modules:["TestManagement/Scripts/Shared/RunTestPointsProxy"],wrappedType:"run-test-points-proxy",wrappedProps:Object.assign({runOption:2},d)};return T.createElement(I.LegacyComponent,t)})),yield n.effects.put(C.TestHubRefreshActions.updateBusyViewStatus(!1));const p={suiteId:e.payload.suiteId,planId:e.payload.planId,pointId:e.payload.pointToResume.id,isAdvancedLicenseEnabled:yield n.effects.select(r.isAdvancedLicenseEnabled)};yield n.effects.put(l.TelemetryActions.publishTelemetry(i.TelemetryConstants.RESUME_TEST,p))}function*K(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"ITestHubDataService");let o;const i=yield n.effects.select(r.isShowTestsFromChildSuitesEnabled);try{o=yield n.effects.call([s,s.getTestPointsForSuite],e.payload.testPlanId,e.payload.testSuiteId,e.payload.testPointIds.join(","),void 0,void 0,void 0,!0,i)}catch(e){(0,S.showErrorToast)(t,G.ErrorFetchingPointsText,e.message,G.Refresh,(()=>{window.location.reload()}))}if(o){yield n.effects.put(q.PointsActions.updateTestPointsForSelectedSuiteSucceded(o.results));(yield n.effects.call(_))&&(yield n.effects.put(q.PointsActions.filterPointsInState()),yield n.effects.put(q.PointsActions.fetchSuitePointCounts()))}(yield n.effects.select(r.getInitiallySelectedSuiteId))===e.payload.testSuiteId&&y.testHubRefreshLocalContextData.makeJsonIslandDataDirty()}function*X(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"ISettingsService"),o=yield n.effects.call([t,t.getService],"ITfsPageService"),i=yield n.effects.call([o,o.getData]);if(e.payload&&e.payload.columnAndWidthMap){let t;t={ExecuteColumnWidths:e.payload.columnAndWidthMap},yield n.effects.call([s,s.setEntries],t,0,"project",i.project.id)}}function*Y(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"ISettingsService"),o=yield n.effects.call([t,t.getService],"ITfsPageService"),i=yield n.effects.call([o,o.getData]);let a=yield n.effects.call([s,s.getEntriesAsync],"",0,"project",i.project.id);a&&a.ExecuteColumnWidths&&(yield n.effects.put(C.TestHubRefreshActions.changeExecuteColumnWidths(void 0,void 0,a.ExecuteColumnWidths)))}function*z(e){const t=yield n.effects.getContext("pageContext"),s=yield n.effects.call([t,t.getService],"ITfsPageService"),o=yield n.effects.call([s,s.getData]),i=yield n.effects.call([t,t.getRestClient],"IWorkItemTrackingRestClient"),a=yield n.effects.call([i,i.getWorkItemTypeCategory],o.project.id,Z.WorkItemTypeCategoryTestCase),l=a?a.defaultWorkItemType.name:"Test Case";let r=new Array;r[o.project.name]=[l];const c={testCaseIds:e.payload.testCaseIds,projectTypeMapping:r,okCallback:e=>{}},d=yield n.effects.call([t,t.getService],"IVssLayoutManager");yield n.effects.call([d,d.renderCallout],(e=>{const t={modules:["TestManagement/Scripts/Shared/TestCaseBulkEditProxy"],wrappedType:"testcase-bulk-edit-proxy",wrappedProps:c,loadingComponent:()=>T.createElement(R.Spinner,{className:"spinner-pos",size:"medium"})};return T.createElement(I.LegacyComponent,t)}))}function j(e){if(!e)return[];let t=e.children||[],s=[e.id];for(let e=0;e<t.length;e++){let o=j(t[e]);s=[...s,...o]}return s}se=t.ReduxPointsSaga={},t.ReduxPointsSaga.PointsSaga=function*(){yield n.effects.takeLatest("Points/initializeExecutePivot",J),yield n.effects.takeLatest("TestHubRefreshActions/editColumnOptionFieldsClicked",$),yield n.effects.debounce(100,"ContentViewObserver/FilterStateChanged",oe),yield n.effects.debounce(200,"ContentViewObserver/FilterStateChanged",ne),yield n.effects.takeLatest("Points/filterPointsInState",oe),yield n.effects.takeLatest("Points/fetchSuitePointCounts",ne),yield n.effects.takeLatest("ContentViewObserver/FilterToggled",ee),yield n.effects.takeLatest("Suites/changeSelectedSuite",ie),yield n.effects.takeLatest("Points/openTestResult",ae),yield n.effects.takeLatest("Points/loadInitialTestPoints",le),yield n.effects.takeLatest("Points/loadTestPointsForSelectedSuite",re),yield n.effects.takeLatest("Suites/loadTestPointsForSelectedSuite",re),yield n.effects.takeLatest("Suites/showTestsFromChildSuitesClick",re),yield n.effects.takeLatest("Points/updateTestPointsForSelectedSuite",ce),yield n.effects.takeLatest("Points/openApplicationTestRunnerClick",de),yield n.effects.takeLatest("Points/openApplicationTestRunnerClickToResumeTest",ue),yield n.effects.takeLatest("Points/openAutomatedTestCasesConfirmationDialog",pe),yield n.effects.takeLatest("Points/openApplicationTestRunner",fe),yield n.effects.takeLatest("Points/openApplicationTestRunnerToResumeTest",Te),yield n.effects.takeLatest("Points/openExistingTestCaseWitForm",me),yield n.effects.takeLatest("Points/openTestPointsRunnerClient",he),yield n.effects.takeLatest("Points/resumeTest",Ce),yield n.effects.takeLatest("Points/refreshTestPointsForWebRunner",Se),yield n.effects.takeLatest("Points/saveColumnWidths",ye),yield n.effects.takeLatest("Points/fetchColumnWidths",ge),yield n.effects.takeLatest("Points/bulkEditTestCases",Ie)},t.ReduxPointsSaga.initializeExecutePivot=s,t.ReduxPointsSaga.editColumnOptionFieldsClicked=o,t.ReduxPointsSaga.filterPointsInState=d,t.ReduxPointsSaga.fetchSuitePointCounts=p,t.ReduxPointsSaga.filterToggled=f,t.ReduxPointsSaga.isFilterActiveOrFilterValueSet=_,t.ReduxPointsSaga.getSuiteCountThresholdFromRegistry=x,t.ReduxPointsSaga.changeSelectedSuite=A,t.ReduxPointsSaga.openTestResult=F,t.ReduxPointsSaga.loadInitialTestPoints=v,t.ReduxPointsSaga.loadTestPointsForSelectedSuite=O,t.ReduxPointsSaga.fetchTestCasesForAllSuites=H,t.ReduxPointsSaga.loadTestPointColumnOptionsForSelectedSuite=k,t.ReduxPointsSaga.updateTestPointsForSelectedSuite=N,t.ReduxPointsSaga.openApplicationTestRunnerClick=L,t.ReduxPointsSaga.openApplicationTestRunnerClickToResumeTest=w,t.ReduxPointsSaga.openAutomatedTestCasesConfirmationDialog=M,t.ReduxPointsSaga.openApplicationTestRunner=D,t.ReduxPointsSaga.openApplicationTestRunnerToResumeTest=U,t.ReduxPointsSaga.openExistingTestCaseWitForm=W,t.ReduxPointsSaga.openTestPointsRunnerClient=V,t.ReduxPointsSaga.resumeTest=B,t.ReduxPointsSaga.refreshTestPointsForWebRunner=K,t.ReduxPointsSaga.saveColumnWidths=X,t.ReduxPointsSaga.fetchColumnWidths=Y,t.ReduxPointsSaga.bulkEditTestCases=z;const J=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(s,e)})),$=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(o,e)})),ee=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(f,e)})),oe=(0,S.errorHandledSaga)((function*(){yield n.effects.call(d)})),ne=(0,S.errorHandledSaga)((function*(){yield n.effects.call(p)})),ie=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(A,e)})),ae=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(F,e)})),le=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(v,e)})),re=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(O,e)})),ce=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(N,e)})),de=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(L,e)})),ue=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(w,e)})),pe=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(M,e)})),fe=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(D,e)})),Te=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(U,e)})),me=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(W,e)})),he=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(V,e)})),Ce=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(B,e)})),Se=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(K,e)})),ye=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(X,e)})),ge=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(Y,e)})),Ie=(0,S.errorHandledSaga)((function*(e){yield n.effects.call(z,e)}))}(),oe=t.ReduxPointsModule={},t.ReduxPointsModule.getPointsModule=function(e,t,s,o,n){const i=[];return i.push(q.PointsActions.initializeExecutePivot(),q.PointsActions.updateAssignTesterDropdownState(!0)),s&&0!=s.length||(n||o!==t||y.testHubRefreshLocalContextData.isJsonIslandDataDirty()?i.push(q.PointsActions.loadTestPointsForSelectedSuite(e,t)):i.push(q.PointsActions.loadInitialTestPoints())),{id:"points",reducerMap:{executeState:$.PointsReducer,testHubRefreshState:_.TestHubRefreshReducer,executeFilterState:J.PointsFilterReducer},sagas:[se.PointsSaga],initialActions:i}},function(e){ne=t[e]={};t[e].TestPointsTableItemProvider=class{constructor(){this._items=new f.ObservableArray}getTestPointsForTable(e,t,s){if(!e||0==e.length)return this._items.removeAll(),this._items;const o=[];if(t&&t.value&&t.value.length>0){const e=t.value.length;for(let s=0;s<e;s++){const e=t.value[s];if(e)for(let t=e.beginIndex;t<=e.endIndex;t++)o.push(t)}}if(this._items.removeAll(),s&&0===s.length)return this._items;for(let t=0;t<e.length;t++){const s=Object.assign({TitleColumn:e[t].testCaseRef.title,OutcomeColumn:this._getOutcomeDetails(e[t].outcomeItem),OrderColumn:e[t].order},e[t].columnOptionValues);this._items.push(s)}if(t&&o&&o.length>0)for(const e of o)t.select(e,1,!0);return this._items}_getTestTitle(e){let t="";return e&&e.testCaseReference&&e.testCaseReference.name&&(t=e.testCaseReference.name),t}_getTesterName(e){let t="";return e&&e.tester&&e.tester.displayName&&(t=e.tester.displayName),t}_getConfigurationName(e){let t="";return e&&e.configuration&&e.configuration.name&&(t=e.configuration.name),t}_getOutcomeDetails(e){let t={};return t=2===e.outcome?{iconProps:{iconName:"CompletedSolid",className:"pass-icon"}}:3===e.outcome?{iconProps:{iconName:"StatusErrorFull",className:"fail-icon"}}:7===e.outcome?{iconProps:{iconName:"Blocked2Solid",className:"block-icon"}}:11===e.outcome?{iconProps:{iconName:"BlockedSolid",className:"not-applicable-icon"}}:12===e.outcome?{iconProps:{iconName:"CirclePauseSolid",className:"active-icon"}}:13===e.outcome?{iconProps:{iconName:"AwayStatus",className:"active-icon"}}:{iconProps:{iconName:"CircleFill",className:"active-icon"}},t.text=e.outcomeString,t}}}("ComponentTestPointsTableItemProvider"),function(e){t[e]={};class s extends O.VssComponent{constructor(e,t){var s;super(e,t),this._lastFocusedTestCaseId=new f.ObservableValue(void 0),this._loadingWorkItem=new f.ObservableValue(!1),this._tableColumns=[],this._columnsVersionKey=1,this._sortingBehavior=new K.ColumnSorting(((e,t,s)=>{if(this._tableColumns[e].sortProps&&this._items.value.length>0){const s=(0,ee.getTestPointItemsComparator)(this._tableColumns[e].id,t),o=s?[s]:[null];(0,K.sortItems)(e,t,o,this._tableColumns,[]),this.props.updateColumnAndSortOrder(this._tableColumns[e].id,t)}})),this._areNonZeroPointsDisplayed=()=>!!(this.props.testPoints&&this.props.testPoints.length>0||this.props.filteredTestPoints&&this.props.filteredTestPoints.length>0),this._onSplitterSizeChange=e=>{this._splitterSize=e;const t=this.context.pageContext.getService("ISettingsService"),s={[`${i.TestHubRefreshConstants.PREVIEW_SPLITTER_SIZE_KEY}/${i.TestHubRefreshConstants.SETTINGS_KEY}`]:e};t.setEntries(s,0)},this._onDragStart=e=>{e.detail.dataTransfer.effectAllowed="none",this.props.showToastNotifications(G.MoveAndReorderTestCasesDisabled,i.TestHubRefreshConstants.TOAST_MESSAGE_DURATION)},this._openTestCaseResultsPanel=()=>{const e=this._testPointTableSelection.value[0].beginIndex;this._showTestCaseResultsPanel.value=!0;const t={testCaseId:this.props.testPoints[e].testCaseRef.id};this.props.publishTelemetry(i.TelemetryConstants.OPEN_TEST_CASE_RESULTS_PANEL,t)},this._updateSelection=e=>{const t=this._testPointTableSelection.value[0].beginIndex;e?this.props.testPoints.length===t+1?this._testPointTableSelection.select(0):this._testPointTableSelection.select(t+1):0===t?this._testPointTableSelection.select(this.props.testPoints.length-1):this._testPointTableSelection.select(t-1)},this._focusFirstTestPoint=e=>{let t;this._testPointTableSelection.select(0),e&&(t=e[0]),t&&t.testCaseRef&&this._onFocusItem(t.testCaseRef.id)},this._setIfSelected=(e,t)=>{const s=this._testPointTableSelection.selectedCount>0;if(s!==this._isSelected.value&&(this._isSelected.value=s),t){const{data:e,index:s}=t;this._onFocusItem(e[i.TestHubRefreshConstants.WorkItemField_Id])}},this._onFocusItem=async e=>{this._lastFocusedTestCaseId.value!==e&&(this._lastFocusedTestCaseId.value=e)},this._getSubMenuBulkMarkItems=()=>{const e=new f.ObservableCollection;return e.push((0,v.getMenuItems)(this.context.pageContext,"ms.vss-test-web.bulkmark-options-menu",this._getBulkMarkMenuDetails())),e},this._getSubMenuItemsForRunOptions=()=>{const e=new f.ObservableCollection;return e.push((0,v.getMenuItems)(this.context.pageContext,"ms.vss-test-web.points-execute-options-menu",this._getRunMenuDetails())),e},this._getContextualTestPointItems=()=>{var e,t,s,o,n,a,l,r,c,d,u,p;const T=new f.ObservableCollection,m={selection:this._testPointTableSelection,planId:this.props.planId,planName:this.props.planName,planAreaPath:this.props.planAreaPath,planIteration:this.props.planIteration,suiteId:this.props.suiteId,suiteName:this.props.suiteName,points:this.props.testPoints,dispatch:this.props.dispatch,isAdvancedLicenseEnabled:this.props.isAdvancedLicenseEnabled,selectedBuild:(0,S.getSelectedBuildObject)(this.props.selectedBuildId),selectedBuildId:this.props.selectedBuildId,selectedReleaseId:this.props.selectedReleaseId,selectedReleaseEnvironmentId:this.props.selectedReleaseEnvironmentId,selectedBuildDefnId:this.props.selectedBuildDefnId,openTestCaseResultsPanel:this._openTestCaseResultsPanel};if(T.push((0,v.getMenuItems)(this.context.pageContext,"ms.vss-test-web.test-point-context-menu",m)),(0,b.isFeatureFlagEnabled)(this.context.pageContext,i.TestHubRefreshConstants.EnableThirdPartyMenuContributionsFF,!1)){const i=[],f=this._testPointTableSelection.value.length,m=this._getProjectName();for(let T=0;T<f;T++)for(let f=this._testPointTableSelection.value[T].beginIndex;f<=this._testPointTableSelection.value[T].endIndex;f++)if(this.props.testPoints[f]){const T={suiteId:this.props.suiteId,suiteName:this.props.suiteName,testCaseId:null===(e=this.props.testPoints[f].testCaseRef)||void 0===e?void 0:e.id,testPointId:this.props.testPoints[f].id,automated:this.props.testPoints[f].isAutomated,build:this.props.selectedBuildId,configurationId:null===(t=this.props.testPoints[f].configuration)||void 0===t?void 0:t.id,configurationName:null===(s=this.props.testPoints[f].configuration)||void 0===s?void 0:s.name,mostRecentResultId:this.props.testPoints[f].lastResultId,mostRecentRunId:this.props.testPoints[f].lastRunId,outcome:null===(o=this.props.testPoints[f].outcomeItem)||void 0===o?void 0:o.outcomeString,sequenceNumber:this.props.testPoints[f].order,state:this.props.testPoints[f].state,assignedTo:null===(a=null===(n=this.props.testPoints[f].testCaseRef)||void 0===n?void 0:n.assignedTo)||void 0===a?void 0:a.displayName,tester:null===(l=this.props.testPoints[f].tester)||void 0===l?void 0:l.id,"System.AssignedTo":null===(c=null===(r=this.props.testPoints[f].testCaseRef)||void 0===r?void 0:r.assignedTo)||void 0===c?void 0:c.displayName,"System.Id":null===(d=this.props.testPoints[f].testCaseRef)||void 0===d?void 0:d.id,"System.State":null===(u=this.props.testPoints[f].testCaseRef)||void 0===u?void 0:u.state,"System.Title":null===(p=this.props.testPoints[f].testCaseRef)||void 0===p?void 0:p.title,"System.WorkItemType":Z.TestCaseWorkItemType,"System.TeamProject":m};i.push(T)}T.push((0,v.getMenuItems)(this.context.pageContext,"ms.vss-test-web.test-run-grid-menu",i))}return T},this._onColumnSize=(e,t,s)=>{this._tableColumns[t].width.value=s,this._columnId=this._tableColumns[t].id,this._columnWidth=s},this._columnSizeEnd=()=>{this.props.changeColumnWidths(this._columnId,this._columnWidth),this.props.saveColumnWidths(this.props.columnAndWidthMap)},this._ttiTelemetrySent=!1,this._columnOptionFieldsChanged=!0,this._columnWidthsChanged=!0,this._testPointTableSelection=new D.ListSelection(!0),this._columnSelect=new K.ColumnSelect,this._eventDispatch=new X.EventDispatch,this._onRightClick=this._onRightClick.bind(this),this._eventDispatch.addEventListener("contextmenu",this._onRightClick),this._eventDispatch.addEventListener("click",this._setIfSelected),this._eventDispatch.addEventListener("keydown",this._setIfSelected),this._provider=new ne.TestPointsTableItemProvider,this._context=t.pageContext,this._asyncLoadInitiated=!1,this._isSelected=new f.ObservableValue(!1),this._showTestCaseResultsPanel=new f.ObservableValue(!1),this._menuItemColumn=new K.ColumnMore((()=>({id:"test-point-context-menu-column",items:this._getContextualTestPointItems()})),void 0,((e,t)=>{this._testPointTableSelection.selected(e)||this._testPointTableSelection.select(e,1,!1)})),this._tableColumns=this._getColumns(),this._dragDropBehavior=new D.ListDragDropBehavior({allowedTypes:[Z.TestPointDragItemType],id:"test-point-table",onDragStart:this._onDragStart,renderDragImage:e=>T.createElement(D.ListDragImage,{text:Z.DragTestPointsText}),type:Z.TestPointDragItemType});const o=this.context.pageContext.getService("ISettingsService").getEntry(i.TestHubRefreshConstants.PREVIEW_SPLITTER_SIZE_KEY,0);o&&o[i.TestHubRefreshConstants.SETTINGS_KEY]&&(this._splitterSize=null!==(s=Number(o[i.TestHubRefreshConstants.SETTINGS_KEY]))&&void 0!==s?s:void 0)}shouldComponentUpdate(e){return this._items=this._provider.getTestPointsForTable(e.testPoints,this._testPointTableSelection,e.filteredTestPoints),this.props.columnOptionFields!==e.columnOptionFields&&(this._columnOptionFieldsChanged=!0,this._columnsVersionKey++),(0,S.compareColumnWidthsMaps)(this.props.columnAndWidthMap,e.columnAndWidthMap)||(this._columnWidthsChanged=!0,this._columnsVersionKey++),e.assignTesterDropdownState||this.props.updateAssignTesterDropdownState(!0),this.props.testPoints&&e.testPoints&&this.props.testPoints[0]&&e.testPoints[0]?this.props.testPoints[0].id!==e.testPoints[0].id&&(this._lastFocusedTestCaseId.value=void 0):this._lastFocusedTestCaseId.value=void 0,e.previewStatus===i.PreviewSplitterOptions.RIGHT&&this._items.value.length>0&&(this._lastFocusedTestCaseId.value||this._focusFirstTestPoint(e.testPoints)),!0}render(){let e;if(this.props.isLoading)this._ttiTelemetrySent=!1,e=T.createElement(R.Spinner,{className:"spinner-pos flex-grow",size:"large"});else if(this.props.testPoints)if(this.props.testPoints.length>0||this.props.filteredTestPoints){let t={};if((0,S.checkIfIsIE)()){let e=document.getElementsByClassName("testplans-hub-refresh-rhs-container")[0].clientHeight-98;t={height:e+"px"}}let s=T.createElement(T.Fragment,null);if(this.props.isPagingInProgress){let e=[];for(let t=0;t<3;t++)e.push(T.createElement("span",{className:"testplans-paging-indication",key:t}));s=T.createElement(T.Fragment,null,e)}e=T.createElement(T.Fragment,null,T.createElement(O.WrappedComponent,{dependencies:["ms.vss-test-web.testplans-hub-refresh-filter-component"],wrappedType:"testplans-hub-refresh-filter-component",className:"execute-pivot-filter-bar bolt-filterbar-white depth-8",filterBarItems:this._getFilterBarItems()}),T.createElement(Y.ScreenSizeObserver,null,(e=>{const o=e.screenSize<=1;return T.createElement(W.Observer,{isSelected:this._isSelected},(e=>{var n;const a=T.createElement("div",{className:"flex-row",style:t},T.createElement(L.CustomCard,{className:"testplans-hub-execute-card bolt-card-with-header",headerClassName:"bolt-card-header bolt-header-with-commandbar"},T.createElement(w.CustomHeader,null,T.createElement(w.HeaderTitle,{titleSize:0,className:"header-title-width bolt-header-title-area flex-grow scroll-hidden bolt-header-title body-xl m header-title"},this._getCardTitle(this.props.testPoints),s),T.createElement(M.CustomHeaderCommandBar,{className:"header-commandbar-width bolt-header-commandbar flex-noshrink bolt-header-commandbar-no-right-padding"},[this._getBulkMarkOutcomeOptionsForHeader(e.isSelected,o),this._getRunOptionsForHeader(e.isSelected,o)])),T.createElement(K.Table,{className:"testplans-hub-execute-tab-testpoints-table",containerClassName:"custom-scrollbar",columns:this._getColumns(),eventDispatch:this._eventDispatch,showLines:!0,scrollable:!0,itemProvider:this._items,selection:this._testPointTableSelection,onSelect:this._setIfSelected,behaviors:[this._sortingBehavior,this._dragDropBehavior],singleClickActivation:!1,onActivate:this._openTestCaseResultsPanel,key:"ExecuteTableVersionKey_"+this._columnsVersionKey}),T.createElement(N.Button,{text:"reload",className:"invisible-reload-button",onClick:()=>this.props.refreshTestPointsForWebRunner(this.props.planId,this.props.suiteId,y.testHubRefreshLocalContextData.getWebRunnerPointIds())})));return(0,b.isFeatureEnabled)(this._context,"ms.vss-work-web.new-boards-hub-feature",!1)&&this.props.previewStatus===i.PreviewSplitterOptions.RIGHT&&this._areNonZeroPointsDisplayed()?T.createElement(B.Splitter,{className:"scroll-hidden",farElementClassName:"flex-column",nearElementClassName:"flex-column",initialFixedSize:null!==(n=this._splitterSize)&&void 0!==n?n:320,onFixedSizeChanged:e=>{this._onSplitterSizeChange(e)},onRenderNearElement:()=>a,onRenderFarElement:()=>T.createElement(W.Observer,{lastFocusedTestCaseId:this._lastFocusedTestCaseId,loadingWorkItem:this._loadingWorkItem},(({lastFocusedTestCaseId:e,loadingWorkItem:t})=>t?T.createElement(R.Spinner,{className:"flex-grow",size:"large"}):e?T.createElement(j.WorkItemFormView,{className:"themed full-height",workItemId:e,onSaveComplete:e=>{this.props.refreshTestPointsForWebRunner(this.props.planId,this.props.suiteId,y.testHubRefreshLocalContextData.getWebRunnerPointIds())}}):null)),splitterDirection:0}):a}))})))}else{const t=(0,H.getAssetLocation)(this.context.pageContext,Z.ExecuteTabZeroDataImagePath);e=T.createElement(z.ZeroData,{imagePath:t,className:"testplans-hub-execute-tab-zero-data",imageAltText:G.ZeroDataImageText,primaryText:G.ZeroDataPrimaryText,secondaryText:G.ZeroDataSecondaryText})}return T.createElement("div",{className:"test-plan-execute-tab"},T.createElement(A.DynamicModuleLoader,{modules:[(0,oe.getPointsModule)(this.props.planId,this.props.suiteId,this.props.testPoints,this.props.initialSelectedSuiteId,this.props.isShowTestsFromChildSuitesEnabled)]},T.createElement("div",{className:"testplans-hub-execute-tab-testpoints-table-container flex-grow"},e)),T.createElement(W.Observer,{showPanel:this._showTestCaseResultsPanel},(e=>e.showPanel&&T.createElement(O.WrappedComponent,{dependencies:["ms.vss-test-web.testcase-results-panel"],wrappedType:"testcase-results-panel",wrappedProps:{showPanel:this._showTestCaseResultsPanel,testPoints:this.props.testPoints,selectedIndex:this._testPointTableSelection.value[0].beginIndex,planId:this.props.planId,updateSelection:this._updateSelection}}))))}_getCardTitle(e){let t="",s=p.Items;return e&&e.length>=0&&(1===e.length&&(s=p.Item),t=G.TestPoints+` (${e.length} ${s})`),t}_getFilterBarItems(){let e;return e=[{filterItemType:1,key:"execute-filter-text",filterItemKey:i.TestHubRefreshConstants.EXECUTE_TEXT_FILTER_ITEM_KEY,placeholder:G.TextFilterPlaceholderText,items:{}},{filterItemType:2,key:"execute-outcome-filter",filterItemKey:i.TestHubRefreshConstants.EXECUTE_OUTCOME_FILTER_ITEM_KEY,placeholder:G.OutcomeFilterPlaceholderText,items:this._getDropdownItems(F.TestHubRefreshFilterCommon.outcomeFilterValues,this.props.outcomeFilterValues),selection:F.TestHubRefreshFilterCommon.outcomeFilterSelection,width:180},{filterItemType:2,key:"execute-tester-filter",filterItemKey:i.TestHubRefreshConstants.EXECUTE_TESTER_FILTER_ITEM_KEY,placeholder:G.TesterFilterPlaceholderText,items:this._getDropdownItems(F.TestHubRefreshFilterCommon.testerFilterValues,this.props.testerFilterValues,!0),selection:F.TestHubRefreshFilterCommon.testerFilterSelection,width:220},{filterItemType:2,key:"execute-configuration-filter",filterItemKey:i.TestHubRefreshConstants.EXECUTE_CONFIGURATION_FILTER_ITEM_KEY,placeholder:G.ConfigurationFilterPlaceholderText,items:this._getDropdownItems(F.TestHubRefreshFilterCommon.configurationFilterValues,this.props.configurationFilterValues),selection:F.TestHubRefreshFilterCommon.configurationFilterSelection,width:220},{filterItemType:2,key:"execute-assignedto-filter",filterItemKey:i.TestHubRefreshConstants.EXECUTE_ASSIGNEDTO_FILTER_ITEM_KEY,placeholder:G.AssignedToFilterPlaceholderText,items:this._getDropdownItems(F.TestHubRefreshFilterCommon.assignedToFilterValues,this.props.assignedToFilterValues),selection:F.TestHubRefreshFilterCommon.assignedToFilterSelection,width:220},{filterItemType:2,key:"execute-state-filter",filterItemKey:i.TestHubRefreshConstants.EXECUTE_STATE_FILTER_ITEM_KEY,placeholder:G.StateFilterPlaceholderText,items:this._getDropdownItems(F.TestHubRefreshFilterCommon.stateFilterValues,this.props.stateFilterValues),selection:F.TestHubRefreshFilterCommon.stateFilterSelection,width:160}],e}componentDidUpdate(){if(this._markTTIPerf(),!this._asyncLoadInitiated&&this.props.initialSelectedSuiteId===this.props.suiteId){const e=(0,S.getDataProviderContent)(this._context);if(e){if(e.testPointsContinuationToken){const t=e.testPointsContinuationToken.split(";");t&&2==t.length&&(t[1]=e.testPointPageSize.toString(),e.testPointsContinuationToken=t.join(";"))}let t="";t=this.props.columnOptionFields?"":e.testCasesContinuationToken,y.testHubRefreshLocalContextData.isJsonIslandDataDirty()&&(e.testPointsContinuationToken=""),(!e.testPoints||e.testPoints.length>0)&&this.props.loadAllTestPoints(this.props.planId,this.props.suiteId,t)}}this._asyncLoadInitiated=!0}_getDropdownItems(e,t,s){if(e&&t)for(const s of t.value)-1===e.value.findIndex((e=>e.text===s.text))&&e.push(s);if(s&&-1===e.value.findIndex((e=>e.text===p.AtMeString))){const t=F.TestHubRefreshFilterCommon.getDefaultAtMeTesterData(this._context);if(t){const s={id:t.value.displayName,text:p.AtMeString,data:t};e.splice(0,0,s)}}return e}_getRunMenuDetails(){return{selection:this._testPointTableSelection,points:this.props.testPoints,planId:this.props.planId,planName:this.props.planName,suiteId:this.props.suiteId,suiteName:this.props.suiteName,planIteration:this.props.planIteration,planAreaPath:this.props.planAreaPath,dispatch:this.props.dispatch,selectedBuildId:this.props.selectedBuildId,selectedReleaseId:this.props.selectedReleaseId,selectedReleaseEnvironmentId:this.props.selectedReleaseEnvironmentId,selectedBuildDefnId:this.props.selectedBuildDefnId}}_getBulkMarkMenuDetails(){return{selection:this._testPointTableSelection,points:this.props.testPoints,planId:this.props.planId,suiteId:this.props.suiteId,dispatch:this.props.dispatch,isAdvancedLicenseEnabled:this.props.isAdvancedLicenseEnabled}}_getBulkMarkOutcomeOptionsForHeader(e,t){return T.createElement(U.MenuButton,{key:"execute-header-bulk-mark-menu-primary-split-button",iconProps:{iconName:"CompletedSolid"},disabled:!e,className:e?"testplans-execute-menu bolt-header-command-item-button "+(t?"command-item-button-width-s":"command-item-button-width"):"testplans-execute-menu-disabled bolt-header-command-item-button "+(t?"command-item-button-width-s":"command-item-button-width"),ariaLabel:G.BulkMarkTestPoints,contextualMenuProps:{menuProps:{id:"subMenu",items:this._getSubMenuBulkMarkItems()}}})}_getRunOptionsForHeader(e,t){return T.createElement(V.SplitButton,{key:"execute-header-run-menu-primary-split-button",disabled:!e,buttonProps:{text:G.RunForWebApplication,className:t?"run-button-width-s":"run-button-width",tooltipProps:t?{text:G.RunForWebApplication}:{},onClick:()=>this._launchWebRunner()},className:"split-button-width",menuButtonProps:{ariaLabel:G.SeeRunTestOptions,className:"menu-button-width",contextualMenuProps:{menuProps:{id:"subMenu2",items:this._getSubMenuItemsForRunOptions()}}}})}_launchWebRunner(){const e=[],t=[],s=this._testPointTableSelection.value.length;for(let o=0;o<s;o++)for(let s=this._testPointTableSelection.value[o].beginIndex;s<=this._testPointTableSelection.value[o].endIndex;s++)this.props.testPoints[s]&&(e.push(this.props.testPoints[s]),t.push(this.props.testPoints[s].id));const o={planAreaPath:this.props.planAreaPath,planId:this.props.planId,planIteration:this.props.planIteration,planName:this.props.planName,points:e,suiteId:this.props.suiteId,suiteName:this.props.suiteName,runOptions:1,selectedBuild:(0,S.getSelectedBuildObject)(this.props.selectedBuildId)};y.testHubRefreshLocalContextData.setWebRunnerPointIds(t),this.props.openTestPointsRunnerClient(o)}_markTTIPerf(){if(this.props.testPoints&&this.props.testhubRefreshContext)if(this.props.testhubRefreshContext.isPageLoad())this.props.markTTIAction(i.TelemetryConstants.TEST_HUB_FEATURE_AREA_NAME,i.TelemetryConstants.EXECUTE_PIVOT_PAGE_LOAD_TTI_SCENARIO,{ttiScenario:"PageLoad"}),this.props.testhubRefreshContext.setPageLoad(!1),this._ttiTelemetrySent=!0;else if(!1===this.props.isLoading&&!1===this._ttiTelemetrySent){const e=this.context.pageContext.getService("IVssPerformanceService");e.getActiveScenario(i.TelemetryConstants.EXECUTE_PIVOT_PAGE_LOAD_TTI_SCENARIO)&&(e.endScenario(i.TelemetryConstants.TEST_HUB_FEATURE_AREA_NAME,i.TelemetryConstants.EXECUTE_PIVOT_PAGE_LOAD_TTI_SCENARIO,!0),this._ttiTelemetrySent=!0)}}_getColumns(){if(0===this._tableColumns.length||this._columnOptionFieldsChanged||this._columnWidthsChanged){if(this._columnWidthsChanged=!1,this._tableColumns=[],this._tableColumns.push(this._columnSelect,{id:Z.TitleColumn,name:G.Title,width:this._getWidth(480,Z.TitleColumn,this.props.columnAndWidthMap),minWidth:10,onSize:this._onColumnSize,onSizeEnd:this._columnSizeEnd,renderCell:K.renderSimpleCell,className:"body-m",sortProps:this.props.columnAndSortOrder&&this.props.columnAndSortOrder.columnId===Z.TitleColumn?{sortOrder:this.props.columnAndSortOrder.sortOrder}:{}}),this._tableColumns.push(this._menuItemColumn),this._tableColumns.push({id:Z.OutcomeColumn,name:G.Outcome,width:this._getWidth(130,Z.OutcomeColumn,this.props.columnAndWidthMap),minWidth:10,onSize:this._onColumnSize,onSizeEnd:this._columnSizeEnd,renderCell:K.renderSimpleCell,className:"body-m",sortProps:this.props.columnAndSortOrder&&this.props.columnAndSortOrder.columnId===Z.OutcomeColumn?{sortOrder:this.props.columnAndSortOrder.sortOrder}:{}},{id:Z.OrderColumn,name:G.Order,width:this._getWidth(80,Z.OrderColumn,this.props.columnAndWidthMap),minWidth:10,onSize:this._onColumnSize,onSizeEnd:this._columnSizeEnd,renderCell:K.renderSimpleCell,className:"body-m",sortProps:this.props.columnAndSortOrder&&this.props.columnAndSortOrder.columnId===Z.OrderColumn?{sortOrder:this.props.columnAndSortOrder.sortOrder}:{}}),this.props.columnOptionFields){this._columnOptionFieldsChanged=!1;const e=(0,u.getAllColumnFields)(this.props.columnOptionFields,this.props.customColumnFieldMap);for(const t of e)this._tableColumns.push({id:t.id,name:t.name,width:this._getWidth(100,t.id,this.props.columnAndWidthMap),minWidth:10,onSize:this._onColumnSize,onSizeEnd:this._columnSizeEnd,renderCell:K.renderSimpleCell,className:"body-m",sortProps:this.props.columnAndSortOrder&&this.props.columnAndSortOrder.columnId===t.id?{sortOrder:this.props.columnAndSortOrder.sortOrder}:{}})}}else{const e=this._tableColumns.indexOf(this._menuItemColumn);this.props.assignTesterDropdownState?-1===e&&this._tableColumns.splice(2,0,this._menuItemColumn):this._tableColumns.splice(e,1)}return this._tableColumns}_getWidth(e,t,s){return s&&void 0!==s[t]?new f.ObservableValue(s[t]):new f.ObservableValue(e)}_onRightClick(e){if(e.button===i.TestHubRefreshConstants.RIGHT_MOUSE_BUTTON){e.preventDefault();const{cellElement:t,rowIndex:s}=(0,D.cellFromEvent)(e);if(s>=0){this._testPointTableSelection.selected(s)||this._testPointTableSelection.select(s,1,!1);this.context.pageContext.getService("IVssLayoutManager").renderCallout((t=>T.createElement(U.ContextualMenu,{menuProps:{id:"test-point-context-menu-column",className:"test-point-context-menu",items:this._getContextualTestPointItems()},anchorElement:e.currentTarget,anchorPoint:{x:e.pageX,y:e.pageY},onDismiss:t},null)))}}}_getProjectName(){const e=this._context.getService("ITfsPageService").getData();let t="";if(!e||!e.project)throw new Error("Project missing");return t=e.project.name,t}}function o(e){const t=T.useContext(y.TestHubRefreshLocalContext);return T.createElement(s,Object.assign({},e,{testhubRefreshContext:t}))}t[e].ExecuteTabContentComponent=s,t[e].ExecuteTabFunctionalComponent=o,t[e].ExecuteTabConnectedComponent=(0,x.connect)((function(e){let t,s,o,n,a,l,c,d,u,p;if(e.executeState&&e.executeState.testPoints){t=(0,te.getTestPointsToRender)(e),s=(0,te.getFilteredTestPoints)(e),o=(0,r.getExecuteColumnOptionFields)(e),p=(0,r.getExecuteTabCustomColumnFieldMap)(e);const f=(0,te.getUniqueFilterValuesToRender)(e);a=f[i.TestHubRefreshConstants.EXECUTE_OUTCOME_FILTER_ITEM_KEY],l=f[i.TestHubRefreshConstants.EXECUTE_TESTER_FILTER_ITEM_KEY],c=f[i.TestHubRefreshConstants.EXECUTE_CONFIGURATION_FILTER_ITEM_KEY],d=f[i.TestHubRefreshConstants.EXECUTE_ASSIGNEDTO_FILTER_ITEM_KEY],u=f[i.TestHubRefreshConstants.EXECUTE_STATE_FILTER_ITEM_KEY],n=e.executeState.assignTesterDropDownState}return{testPoints:t,filteredTestPoints:s,columnOptionFields:o,customColumnFieldMap:p,suiteId:e.testHubRefreshState.selectedSuiteId,suiteName:e.testHubRefreshState.selectedSuiteName,initialSelectedSuiteId:e.testHubRefreshState.initialSelectedSuiteId,planId:e.testHubRefreshState.testPlanId,planName:e.testHubRefreshState.testPlanName,planAreaPath:e.testHubRefreshState.testPlanAreaPath,planIteration:e.testHubRefreshState.testPlanIteration,isLoading:e.testHubRefreshState.isLoading,isAdvancedLicenseEnabled:e.testHubRefreshState.isAdvancedExtensionEnabled,isShowTestsFromChildSuitesEnabled:e.testHubRefreshState.isShowTestsFromChildSuitesEnabled,outcomeFilterValues:a,testerFilterValues:l,configurationFilterValues:c,assignedToFilterValues:d,stateFilterValues:u,assignTesterDropdownState:n,isPagingInProgress:e.testHubRefreshState.isPagingInProgress,columnAndSortOrder:e.executeState&&e.executeState.columnAndSortOrder?e.executeState.columnAndSortOrder:void 0,columnAndWidthMap:e.testHubRefreshState.executeColumnAndWidthMap,selectedBuildId:e.testHubRefreshState.selectedBuildId,selectedReleaseId:e.testHubRefreshState.selectedReleaseId,selectedReleaseEnvironmentId:e.testHubRefreshState.selectedReleaseEnvironmentId,selectedBuildDefnId:e.testHubRefreshState.selectedBuildDefnId,previewStatus:e.testHubRefreshState.testCasePreviewStatus}}),(function(e){return{markTTIAction:(t,s,o)=>e(k.TTIMonitorActions.markTTI(t,s,o)),loadAllTestPoints:(t,s,o)=>e(q.PointsActions.loadTestPointsForSelectedSuite(t,s,o)),refreshTestPointsForWebRunner:(t,s,o)=>e(q.PointsActions.refreshTestPointsForWebRunner(t,s,o)),updateAssignTesterDropdownState:t=>e(q.PointsActions.updateAssignTesterDropdownState(t)),openTestPointsRunnerClient:t=>e(q.PointsActions.openTestPointsRunnerClient(t)),updateColumnAndSortOrder:(t,s)=>e(q.PointsActions.updateColumnAndSortOrder(t,s)),changeColumnWidths:(t,s)=>e(C.TestHubRefreshActions.changeExecuteColumnWidths(t,s,void 0)),saveColumnWidths:t=>e(q.PointsActions.saveColumnWidths(t)),showToastNotifications:(t,s)=>e(a.SuitesActions.showToastNotifications(t,s)),publishTelemetry:(t,s)=>e(l.TelemetryActions.publishTelemetry(t,s)),dispatch:e}}))(o),O.VssComponent.register("executePivot",t[e].ExecuteTabConnectedComponent)}("ComponentExecuteTabConnectedComponent")}),["Resources","ExecuteConstants","Redux/PointsActions","Redux/PointsFilterReducer","Redux/PointsReducer","Redux/PointsFilterHelper","TestPointsSortingUtility","Redux/PointsSelector","Redux/PointsSaga","Redux/PointsModule","Component/TestPointsTableItemProvider","Component/ExecuteTabConnectedComponent"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-test-web.execute-component"}}));