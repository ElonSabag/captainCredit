"use strict";define("VSSUI",["require","exports","react","VSS/Core/Observable","VSS/Platform/Date","VSS/Platform/Layout"],(function(e,t,r,a,i,s){var o,n,c,l,u,d,p,h,m;o=t.ResourcesDatePicker={},t.ResourcesDatePicker.Loading="Loading...",t.ResourcesDatePicker.clearDateButton="Clear",t.ResourcesDatePicker.goToToday="Go to today",t.ResourcesDatePicker.invalidInputErrorMessage="Invalid date value specified.",t.ResourcesDatePicker.isRequiredErrorMessage="A valid date is required",t.ResourcesDatePicker.isOutOfBoundsErrorMessage="Selected date is not within the valid range",t.ResourcesDatePicker.DatePickerCalloutLabel="Date Picker Callout",t.ResourcesDatePicker.sunday="Sunday",t.ResourcesDatePicker.monday="Monday",t.ResourcesDatePicker.tuesday="Tuesday",t.ResourcesDatePicker.wednesday="Wednesday",t.ResourcesDatePicker.thursday="Thursday",t.ResourcesDatePicker.friday="Friday",t.ResourcesDatePicker.saturday="Saturday",t.ResourcesDatePicker.sun="Sun",t.ResourcesDatePicker.mon="Mon",t.ResourcesDatePicker.tue="Tue",t.ResourcesDatePicker.wed="Wed",t.ResourcesDatePicker.thu="Thu",t.ResourcesDatePicker.fri="Fri",t.ResourcesDatePicker.sat="Sat",t.ResourcesDatePicker.january="January",t.ResourcesDatePicker.february="February",t.ResourcesDatePicker.march="March",t.ResourcesDatePicker.april="April",t.ResourcesDatePicker.may="May",t.ResourcesDatePicker.june="June",t.ResourcesDatePicker.july="July",t.ResourcesDatePicker.august="August",t.ResourcesDatePicker.september="September",t.ResourcesDatePicker.october="October",t.ResourcesDatePicker.november="November",t.ResourcesDatePicker.december="December",t.ResourcesDatePicker.jan="Jan",t.ResourcesDatePicker.feb="Feb",t.ResourcesDatePicker.mar="Mar",t.ResourcesDatePicker.apr="Apr",t.ResourcesDatePicker.jun="Jun",t.ResourcesDatePicker.jul="Jul",t.ResourcesDatePicker.aug="Aug",t.ResourcesDatePicker.sep="Sep",t.ResourcesDatePicker.oct="Oct",t.ResourcesDatePicker.nov="Nov",t.ResourcesDatePicker.dec="Dec",t.ResourcesDatePicker.prevMonthAriaLabel="Go to previous month",t.ResourcesDatePicker.nextMonthAriaLabel="Go to next month",t.ResourcesDatePicker.prevYearAriaLabel="Go to previous year",t.ResourcesDatePicker.nextYearAriaLabel="Go to next year",function(e){n=t[e]={};t[e].ScreenContext=r.createContext(new class{constructor(){this.onResize=()=>{const e=this.getCurrentSize();this.size.value!==e&&(this.size.value=e)},this.size=new a.ObservableValue(this.getCurrentSize()),window.addEventListener("resize",this.onResize)}getCurrentSize(){return window.innerWidth>=750?1:0}})}("UtilsCustomizedScreen"),function(e){c=t[e]={};t[e].CustomizedScreenSizeObserver=e=>r.createElement(n.ScreenContext.Consumer,null,(a=>r.createElement(t.Observer.Observer,{screenSize:a.size},e.children)));t[e].ScreenSizeConditional=a=>r.createElement(t[e].CustomizedScreenSizeObserver,null,(e=>a.condition(e.screenSize)&&a.children))}("UtilsCustomizedScreenSize"),l=t[m="ComponentsDatePickerDateStringHelper"]={},t[m].datePickerStrings=function(){return{months:[o.january,o.february,o.march,o.april,o.may,o.june,o.july,o.august,o.september,o.october,o.november,o.december],shortMonths:[o.jan,o.feb,o.mar,o.apr,o.may,o.jun,o.jul,o.aug,o.sep,o.oct,o.nov,o.dec],days:[o.sunday,o.monday,o.tuesday,o.wednesday,o.thursday,o.friday,o.saturday],shortDays:[o.sun,o.mon,o.tue,o.wed,o.thu,o.fri,o.sat],goToToday:o.goToToday,clear:o.clearDateButton,prevMonthAriaLabel:o.prevMonthAriaLabel,nextMonthAriaLabel:o.nextMonthAriaLabel,prevYearAriaLabel:o.prevYearAriaLabel,nextYearAriaLabel:o.nextYearAriaLabel}},function(e){u=t[e]={};class a extends r.Component{constructor(e){super(e),this.containerDiv=r.createRef(),this.calendarDismissed=()=>{this.hidePicker()},this.onClick=e=>{e.defaultPrevented||this.props.disabled||(this.setState({pickerShown:!0}),e.preventDefault())},this.onChange=(e,t)=>{var r,a;this.setState({dateStr:t}),null===(a=(r=this.props).debounceOnChange)||void 0===a||a.call(r,t)},this.onTextFieldKeyDown=e=>{var t,r,a;if(!e.defaultPrevented&&!this.props.disabled)switch(e.which){case 40:case 13:this.setState({pickerShown:!0}),e.preventDefault();break;case 27:this.hidePicker(),e.preventDefault();break;case 8:case 46:this.props.showClear&&!(null===(t=this.props.manualEditingOptions)||void 0===t?void 0:t.value)&&(null===(a=(r=this.props).onChange)||void 0===a||a.call(r,void 0))}},this.onSelectDate=e=>{var t,r;this.hidePicker(),null===(r=(t=this.props).onChange)||void 0===r||r.call(t,e)},this.renderSpinner=()=>r.createElement("div",{className:"bolt-date-picker-spinner flex-row flex-center justify-center"},r.createElement(t.Spinner.Spinner,{label:o.Loading,size:"large"})),this.state={pickerShown:!1,dateStr:void 0}}componentDidMount(){this.props.expandOnMount&&this.setState({pickerShown:!0})}render(){const{containerClassName:e}=this.props,a=Object.assign({preprocessKeyStroke:e=>3},this.props.focusZoneProps);return r.createElement(t.Observer.Observer,{date:this.props.value,manualEditingOptions:this.props.manualEditingOptions},(i=>r.createElement("div",{className:e,ref:this.containerDiv},r.createElement(t.FormItem.FormItem,{error:this.props.hasError,message:this.props.errorMessage},r.createElement(t.TextField.TextField,{ariaControls:this.state.pickerShown?this.props.calendarId:void 0,ariaExpanded:this.state.pickerShown,ariaHasPopup:!0,ariaLabel:this.props.ariaLabel,ariaLabelledBy:this.props.ariaLabelledBy,className:(0,t.Util.css)("flex-row flex-grow",this.props.className),disabled:this.props.disabled,inputClassName:"bolt-date-picker-input",inputId:this.props.inputId,onClick:i.manualEditingOptions?void 0:this.onClick,onKeyDown:this.onTextFieldKeyDown,onChange:i.manualEditingOptions?this.onChange:void 0,readOnly:!i.manualEditingOptions,role:"combobox",suffixIconProps:this.getSuffixIconProps(i.manualEditingOptions),placeholder:this.props.placeholder,value:this.getValue(i)})),this.state.pickerShown&&r.createElement(c.CustomizedScreenSizeObserver,null,(e=>{var n;const c=0===e.screenSize;return r.createElement(t.Callout.Callout,{anchorElement:c?void 0:null!==(n=this.containerDiv.current)&&void 0!==n?n:void 0,anchorOrigin:c?void 0:{horizontal:"start",vertical:"end"},ariaLabel:this.props.calloutAriaLabel||o.DatePickerCalloutLabel,contentClassName:"depth-8 bolt-date-picker",contentLocation:c?0:void 0,contentShadow:!0,id:this.props.calendarId,onDismiss:this.calendarDismissed,escDismiss:!0,lightDismiss:!0,focuszoneProps:a},r.createElement(s.WrappedComponent,{className:"bolt-date-picker",dependencies:["ms.vss-features.ui-calendar-content"],loadingComponent:this.renderSpinner,wrappedProps:{onSelectDate:this.onSelectDate,onDismiss:this.calendarDismissed,shouldFocusOnMount:!0,showClear:this.props.showClear,minDate:this.props.minDate,maxDate:this.props.maxDate,value:i.date,strings:(0,l.datePickerStrings)()},wrappedType:"fabric.pickers.calendar"}))})))))}hidePicker(){var e,t;this.setState({pickerShown:!1}),null===(t=(e=this.props).onCollapse)||void 0===t||t.call(e)}toLocaleTimeString(e){return e instanceof Date?(0,i.localeDateFormat)(e,"t",new Intl.DateTimeFormat(void 0,{hour:"numeric",minute:"numeric"})):void 0}getValue(e){if(e.manualEditingOptions){if(this.state.dateStr)return this.state.dateStr;if(1===e.manualEditingOptions.datePickerType)return this.toLocaleTimeString(e.date)}return e.date&&e.date instanceof Date?(0,i.localeDateFormat)(e.date,"d",new Intl.DateTimeFormat(void 0,{year:"numeric",month:"numeric",day:"numeric"})):void 0}getSuffixIconProps(e){return{iconName:1===(null==e?void 0:e.datePickerType)?"Clock":"Calendar",onClick:1===(null==e?void 0:e.datePickerType)?void 0:this.onClick}}}t[e].DatePicker=a}("ComponentsDatePickerDatePicker"),function(e){d=t[e]={},__exportStar(u,t[e])}("ComponentsDatePickerindex"),function(e){p=t[e]={};class i extends t.FilterBarItem.FilterBarItem{constructor(e){super(e),this.filterDate=new a.ObservableValue(void 0),this.componentDidMount=()=>{var e;if(super.componentDidMount(),this.props.filter){const t=null===(e=this.props.filter)||void 0===e?void 0:e.getFilterItemState(this.props.filterItemKey);this.onFilterChanged(t)}},this.onFilterChanged=e=>{super.onFilterChanged(e),e&&e.value?this.filterDate.value=e.value:this.filterDate.value=void 0},this._onSelectionChanged=e=>{this.setFilterValue({value:e}),this.filterDate.value=e},this.filterDate.value=e.initialValue}focus(){return!1}render(){return r.createElement("div",{className:"bolt-date-picker-filterbar-item"},r.createElement(u.DatePicker,{value:this.filterDate,onChange:this._onSelectionChanged,placeholder:this.props.placeholder}))}}t[e].DatePickerFilterBarItem=i}("ComponentsDatePickerFilterBarItemDatePickerFilterBarItem"),function(e){h=t[e]={},__exportStar(p,t[e])}("ComponentsDatePickerFilterBarItemindex"),t.DatePicker={},__exportStar(d,t.DatePicker),__exportStar(h,t.DatePicker)}),["Resources.DatePicker","Utils/CustomizedScreen","Utils/CustomizedScreenSize","Components/DatePicker/DateStringHelper","Components/DatePicker/DatePicker","Components/DatePicker/index","Components/DatePickerFilterBarItem/DatePickerFilterBarItem","Components/DatePickerFilterBarItem/index","DatePicker"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-date-picker-content"}}));